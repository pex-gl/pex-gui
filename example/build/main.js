/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={8365:(t,e,r)=>{const i=r(8064),n=r(2829),a=r(2278),o=r(8495),s=r(a?5580:103),c=r(6609),l=r(9298),u=r(4569),h=r(602),f=r(45);function d(t,{theme:e={}}={}){const r=t.gl.drawingBufferWidth,i=t.gl.drawingBufferHeight;this._ctx=t,this._textureRect=[0,0,r,i],this._viewport=[0,0,r,i],this._timeSinceLastUpdate=0,this._prev=Date.now()/1e3,this.x=0,this.y=0,this.mousePos=[0,0],this.scale=1,o.polyfill();const n=[[-1,-1],[1,-1],[1,1],[-1,1]],a=[[0,0],[1,0],[1,1],[0,1]],c=[[0,1,2],[0,2,3]];this.drawTexture2dCmd={name:"gui_drawTexture2d",pipeline:t.pipeline({vert:u,frag:f,depthTest:!1,depthWrite:!1,blend:!0,blendSrcRGBFactor:t.BlendFactor.SrcAlpha,blendSrcAlphaFactor:t.BlendFactor.One,blendDstRGBFactor:t.BlendFactor.OneMinusSrcAlpha,blendDstAlphaFactor:t.BlendFactor.One}),attributes:{aPosition:{buffer:t.vertexBuffer(n)},aTexCoord0:{buffer:t.vertexBuffer(a)}},indices:{buffer:t.indexBuffer(c)},uniforms:{}},this.drawTextureCubeCmd={name:"gui_drawTextureCube",pipeline:t.pipeline({vert:u,frag:h,depthTest:!1,depthWrite:!1,blend:!0,blendSrcRGBFactor:t.BlendFactor.SrcAlpha,blendSrcAlphaFactor:t.BlendFactor.One,blendDstRGBFactor:t.BlendFactor.OneMinusSrcAlpha,blendDstAlphaFactor:t.BlendFactor.One}),attributes:{aPosition:{buffer:t.vertexBuffer(n)},aTexCoord0:{buffer:t.vertexBuffer(a)}},indices:{buffer:t.indexBuffer(c)},uniforms:{uFlipEnvMap:1}},this.drawTexture2d=e=>{t.submit(this.drawTexture2dCmd,{viewport:this._viewport,uniforms:{uTexture:e.texture,uTextureEncoding:e.texture.encoding,uViewport:this._viewport,uRect:e.rect}})},this.drawTextureCube=e=>{t.submit(this.drawTextureCubeCmd,{viewport:this._viewport,uniforms:{uTexture:e.texture,uTextureEncoding:e.texture.encoding,uViewport:this._viewport,uRect:e.rect,uLevel:e.level,uFlipEnvMap:e.flipEnvMap||1}})},this.renderer=new s(t,{...l,...e}),this.items=[],this.enabled=!0,t.gl.canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),t.gl.canvas.addEventListener("mousemove",this.onMouseDrag.bind(this)),t.gl.canvas.addEventListener("mouseup",this.onMouseUp.bind(this)),window.addEventListener("keydown",this.onKeyDown.bind(this))}d.prototype.onMouseDown=function(t){if(!this.enabled)return;this.items.forEach((function(t){"text"===t.type&&t.focus&&(t.focus=!1,t.dirty=!0)})),this.activeControl=null;let e=t.offsetX,r=t.offsetY;e-=this.x,r-=this.y,this.mousePos[0]=e,this.mousePos[1]=r;for(let r=0;r<this.items.length;r++){const n=this.items.filter(((t,e)=>e<r&&"tab"===t.type)),a=n[n.length-1];if((!a||a.current||"tab"===this.items[r].type)&&i.containsPoint(this.getScaledActiveArea(this.items[r].activeArea),this.mousePos)){this.activeControl=this.items[r];const n=this.getScaledActiveArea(this.activeControl.activeArea),a=n[1][0]-n[0][0],o=n[1][1]-n[0][1];if(this.activeControl.active=!0,this.activeControl.dirty=!0,"button"===this.activeControl.type)this.activeControl.onClick&&this.activeControl.onClick();else if("tab"===this.activeControl.type)this.activeControl.setActive(!0);else if("toggle"===this.activeControl.type)this.activeControl.contextObject[this.activeControl.attributeName]=!this.activeControl.contextObject[this.activeControl.attributeName],this.activeControl.onchange&&this.activeControl.onchange(this.activeControl.contextObject[this.activeControl.attributeName]);else if("radiolist"===this.activeControl.type){const t=this.mousePos[1]-n[0][1],e=Math.floor(this.activeControl.items.length*t/o);if(e<0)continue;if(e>=this.activeControl.items.length)continue;this.activeControl.contextObject[this.activeControl.attributeName]=this.activeControl.items[e].value,this.activeControl.onchange&&this.activeControl.onchange(this.activeControl.items[e].value)}else if("texturelist"===this.activeControl.type){let t=null;if(this.activeControl.items.forEach(function(e){i.containsPoint(this.getScaledActiveArea(e.activeArea),this.mousePos)&&(t=e)}.bind(this)),!t)continue;this.activeControl.contextObject[this.activeControl.attributeName]=t.value,this.activeControl.onchange&&this.activeControl.onchange(t.value)}else if("color"===this.activeControl.type){if(this.activeControl.options.palette){const t=this.activeControl.options.paletteImage.width,r=this.activeControl.options.paletteImage.height;let i=e-n[0][1];const s=a*r/t,c=o-s;if(i>c){const o=(e-n[0][0])/a,l=(i-c)/s,u=Math.floor(t*o);i=Math.floor(r*l);const h=this.renderer.getImageColor(this.activeControl.options.paletteImage,u,i);this.activeControl.dirty=!0,this.activeControl.contextObject[this.activeControl.attributeName][0]=h[0],this.activeControl.contextObject[this.activeControl.attributeName][1]=h[1],this.activeControl.contextObject[this.activeControl.attributeName][2]=h[2],this.activeControl.onchange&&this.activeControl.onchange(this.activeControl.contextObject[this.activeControl.attributeName]);continue}}}else"text"===this.activeControl.type&&(this.activeControl.focus=!0);t.stopPropagation(),this.onMouseDrag(t),t.preventDefault();break}}},d.prototype.onMouseDrag=function(t){if(!this.enabled)return;let e=t.offsetX,r=t.offsetY;if(e-=this.x,r-=this.y,this.activeControl){const i=this.getScaledActiveArea(this.activeControl.activeArea),n=i[1][0]-i[0][0],a=i[1][1]-i[0][1];let o=0,s=0;if("slider"===this.activeControl.type)o=(e-i[0][0])/n,o=Math.max(0,Math.min(o,1)),this.activeControl.setNormalizedValue(o),this.activeControl.onchange&&this.activeControl.onchange(this.activeControl.contextObject[this.activeControl.attributeName]),this.activeControl.dirty=!0;else if("multislider"===this.activeControl.type)o=(e-i[0][0])/n,o=Math.max(0,Math.min(o,1)),s=Math.floor(this.activeControl.getValue().length*(r-i[0][1])/a),isNaN(this.activeControl.clickedSlider)?this.activeControl.clickedSlider=s:s=this.activeControl.clickedSlider,this.activeControl.setNormalizedValue(o,s),this.activeControl.onchange&&this.activeControl.onchange(this.activeControl.contextObject[this.activeControl.attributeName]),this.activeControl.dirty=!0;else if("color"===this.activeControl.type){const c=this.activeControl.options.alpha?4:3;let l=a;if(this.activeControl.options.palette){const o=this.activeControl.options.paletteImage.width,s=this.activeControl.options.paletteImage.height;let c=r-i[0][1];l=a-n*s/o;const u=n*s/o,h=a-u;if(c>h&&isNaN(this.activeControl.clickedSlider)){const r=(e-i[0][0])/n,a=(c-h)/u,l=Math.floor(o*r);c=Math.floor(s*a);const f=this.renderer.getImageColor(this.activeControl.options.paletteImage,l,c);return this.activeControl.dirty=!0,this.activeControl.contextObject[this.activeControl.attributeName][0]=f[0],this.activeControl.contextObject[this.activeControl.attributeName][1]=f[1],this.activeControl.contextObject[this.activeControl.attributeName][2]=f[2],this.activeControl.onchange&&this.activeControl.onchange(this.activeControl.contextObject[this.activeControl.attributeName]),void t.stopPropagation()}}o=(e-i[0][0])/n,o=Math.max(0,Math.min(o,1)),s=Math.floor(c*(r/this._ctx.pixelRatio-i[0][1])/l),isNaN(this.activeControl.clickedSlider)?this.activeControl.clickedSlider=s:s=this.activeControl.clickedSlider,this.activeControl.setNormalizedValue(o,s),this.activeControl.onchange&&this.activeControl.onchange(this.activeControl.contextObject[this.activeControl.attributeName]),this.activeControl.dirty=!0}t.stopPropagation()}},d.prototype.onMouseUp=function(){this.enabled&&this.activeControl&&(this.activeControl.active=!1,this.activeControl.dirty=!0,this.activeControl.clickedSlider=void 0,this.activeControl=null)},d.prototype.onKeyDown=function(t){const e=this.items.filter((function(t){return"text"===t.type&&t.focus}))[0];if(!e)return;switch(t.key){case"Backspace":{const r=e.contextObject[e.attributeName];e.contextObject[e.attributeName]=r.substr(0,Math.max(0,r.length-1)),e.dirty=!0,e.onchange&&e.onchange(e.contextObject[e.attributeName]),t.stopImmediatePropagation(),t.preventDefault();break}}const r=t.key.charCodeAt(0);1===t.key.length&&r>=32&&r<=126&&(e.contextObject[e.attributeName]+=t.key,e.dirty=!0,e.onchange&&e.onchange(e.contextObject[e.attributeName]),t.stopImmediatePropagation(),t.preventDefault())},d.prototype.addTab=function(t,e,r,i){const n=this.items.filter((t=>"tab"===t.type)).length,a=this,o=new c({type:"tab",title:t,current:0===n,activeArea:[[0,0],[0,0]],contextObject:e,attributeName:r,value:i?i.value:null,onChange:i?i.onChange:null,setActive:function(){a.items.filter((t=>"tab"===t.type)).forEach((t=>{t.current=t===this}));let t=null;e&&(t=e[r],e[r]=this.value),this.onChange&&this.onChange(t,this.value)}});return this.items.push(o),o},d.prototype.addColumn=function(t,e){const r=new c({width:e||160,type:"column",activeArea:[[0,0],[0,0]]});this.items.push(r);const i=new c({type:"header",title:t,dirty:!0,activeArea:[[0,0],[0,0]],setTitle:function(t){this.title=t,this.dirty=!0}});return this.items.push(i),r},d.prototype.addHeader=function(t){const e=new c({type:"header",title:t,dirty:!0,activeArea:[[0,0],[0,0]],setTitle:function(t){this.title=t,this.dirty=!0}});return this.items.push(e),e},d.prototype.addSeparator=function(){const t=new c({type:"separator",dirty:!0,activeArea:[[0,0],[0,0]]});return this.items.push(t),t},d.prototype.addLabel=function(t){const e=new c({type:"label",title:t,dirty:!0,activeArea:[[0,0],[0,0]],setTitle:function(t){this.title=t,this.dirty=!0}});return this.items.push(e),e},d.prototype.addParam=function(t,e,r,i,n){let a=null;if(void 0===(i=i||{}).min&&(i.min=0),void 0===i.max&&(i.max=1),hasOwnProperty.call(e[r],"class")&&"texture"===e[r].class){const n=e[r];return a=n.target===this._ctx.gl.TEXTURE_CUBE_MAP?new c({type:"textureCube",title:t,contextObject:e,attributeName:r,texture:n,options:i||{flipEnvMap:1},activeArea:[[0,0],[0,0]],dirty:!0}):new c({type:"texture2D",title:t,contextObject:e,attributeName:r,texture:n,options:i,activeArea:[[0,0],[0,0]],dirty:!0}),this.items.push(a),a}return!1===e[r]||!0===e[r]?(a=new c({type:"toggle",title:t,contextObject:e,attributeName:r,activeArea:[[0,0],[0,0]],options:i,onchange:n,dirty:!0}),this.items.push(a),a):isNaN(e[r])?e[r]instanceof Array&&i&&"color"===i.type?(a=new c({type:"color",title:t,contextObject:e,attributeName:r,activeArea:[[0,0],[0,0]],options:i,onchange:n,dirty:!0}),this.items.push(a),a):e[r]instanceof Array?(a=new c({type:"multislider",title:t,contextObject:e,attributeName:r,activeArea:[[0,0],[0,0]],options:i,onchange:n,dirty:!0}),this.items.push(a),a):"string"==typeof e[r]?(a=new c({type:"text",title:t,contextObject:e,attributeName:r,activeArea:[[0,0],[0,0]],options:i,onchange:n,dirty:!0}),this.items.push(a),a):void 0:(a=new c({type:"slider",title:t,contextObject:e,attributeName:r,activeArea:[[0,0],[0,0]],options:i,onchange:n,dirty:!0}),this.items.push(a),a)},d.prototype.addButton=function(t,e){const r=new c({type:"button",title:t,onClick:e,activeArea:[[0,0],[0,0]],dirty:!0,options:{}});return this.items.push(r),r},d.prototype.addRadioList=function(t,e,r,i,n){const a=new c({type:"radiolist",title:t,contextObject:e,attributeName:r,activeArea:[[0,0],[0,0]],items:i,onchange:n,dirty:!0});return this.items.push(a),a},d.prototype.addTexture2DList=function(t,e,r,i,n,a){const o=new c({type:"texturelist",title:t,contextObject:e,attributeName:r,activeArea:[[0,0],[0,0]],items:i,itemsPerRow:n||4,onchange:a,dirty:!0});return this.items.push(o),o},d.prototype.addTexture2D=function(t,e,r){const i=new c({type:"texture2D",title:t,texture:e,options:r,activeArea:[[0,0],[0,0]],dirty:!0});return this.items.push(i),i},d.prototype.addTextureCube=function(t,e,r){const i=new c({type:"textureCube",title:t,texture:e,options:r||{flipEnvMap:1},activeArea:[[0,0],[0,0]],dirty:!0});return this.items.push(i),i},d.prototype.addFPSMeeter=function(){const t=new c({type:"fps",title:"FPS",activeArea:[[0,0],[0,0]],dirty:!0,currentValue:30,values:[],time:new n});return this.items.push(t),t},d.prototype.isAnyItemDirty=function(t){let e=!1;return t.forEach((function(t){t.dirty&&(t.dirty=!1,e=!0)})),e},d.prototype.getScaledActiveArea=function(t){return t.map((t=>t.map((t=>t*this.scale))))},d.prototype.update=function(){const t=Date.now()/1e3,e=t-this._prev;this._timeSinceLastUpdate+=e,this._prev=t;let r=!1;this._timeSinceLastUpdate>2&&(this._timeSinceLastUpdate=0,r=!0);for(let t=0;t<this.items.length;t++){const e=this.items[t];"fps"===e.type?(e.time._update(Date.now()),r&&(e.currentValue=Math.floor(e.time.getFPS()),e.values.push(e.currentValue)),e.dirty=r):"stats"===e.type&&(e.update(),e.dirty=r)}},d.prototype.draw=function(){if(!this.enabled)return;if(this.update(),0===this.items.length)return;const t=this._ctx.gl.drawingBufferWidth,e=this._ctx.gl.drawingBufferHeight;let r=!1;t===this._viewport[2]&&e===this._viewport[3]||(this._viewport[2]=t,this._viewport[3]=e,r=!0),(this.isAnyItemDirty(this.items)||r||this.renderer.dirty)&&this.renderer.draw(this.items);const i=this.renderer.getTexture();this._textureRect[2]=i.width*this.scale,this._textureRect[3]=i.height*this.scale,this.drawTexture2d({texture:i,rect:this._textureRect}),this.drawTextures()},d.prototype.drawTextures=function(){const t=this.items,e=t.filter((t=>"tab"===t.type));for(let i=0;i<this.items.length;i++){const n=this.items[i];if(e.length>0){const e=t.filter(((t,e)=>e<i&&"tab"===t.type)),r=e[e.length-1];if(r&&!r.current)continue}const a=this.scale*this._ctx.pixelRatio;let o=[];if("texture2D"===n.type){if(o=[n.activeArea[0][0]*a,n.activeArea[1][1]*a,n.activeArea[1][0]*a,n.activeArea[0][1]*a],n.texture.flipY){var r=o[1];o[1]=o[3],o[3]=r}this.drawTexture2d({texture:n.contextObject?n.contextObject[n.attributeName]:n.texture,rect:o})}if("texturelist"===n.type&&n.items.forEach(function(t){if(o=[t.activeArea[0][0]*a,t.activeArea[1][1]*a,t.activeArea[1][0]*a,t.activeArea[0][1]*a],t.texture.flipY){var e=o[1];o[1]=o[3],o[3]=e}this.drawTexture2d({texture:t.texture,rect:o})}.bind(this)),"textureCube"===n.type){const t=n.options&&void 0!==n.options.level?n.options.level:0;o=[n.activeArea[0][0]*a,n.activeArea[1][1]*a,n.activeArea[1][0]*a,n.activeArea[0][1]*a],this.drawTextureCube({texture:n.contextObject?n.contextObject[n.attributeName]:n.texture,rect:o,level:t,flipEnvMap:n.options.flipEnvMap})}}},d.prototype.serialize=function(){const t={};return this.items.forEach((function(e){t[e.title]=e.getSerializedValue()})),t},d.prototype.deserialize=function(t){this.items.forEach((function(e){void 0!==t[e.title]&&(e.setSerializedValue(t[e.title]),e.dirty=!0)}))},d.prototype.setEnabled=function(t){this.enabled=t},d.prototype.isEnabled=function(){return this.enabled},d.prototype.toggleEnabled=function(){return this.enabled=!this.enabled,this.enabled},d.prototype.dispose=function(){this._ctx.gl.canvas.removeEventListener("mousedown",this.onMouseDown),this._ctx.gl.canvas.removeEventListener("mousemove",this.onMouseDrag),this._ctx.gl.canvas.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("keydown",this.onKeyDown),this.items.length=0,this.renderer.dispose()},t.exports=function(t,e){return new d(t,e)}},6609:(t,e,r)=>{const i=r(8204),n=r(2240);function a(t){Object.assign(this,t)}a.prototype.setPosition=function(t,e){this.px=t,this.py=e},a.prototype.getNormalizedValue=function(t){if(!this.contextObject)return 0;var e=this.contextObject[this.attributeName],r=this.options;if(r&&void 0!==r.min&&void 0!==r.max)if("multislider"===this.type)e=(e[t]-r.min)/(r.max-r.min);else if("color"===this.type){var n=i(e);0===t&&(e=n[0]),1===t&&(e=n[1]),2===t&&(e=n[2]),3===t&&(e=e[4])}else e=(e-r.min)/(r.max-r.min);return e},a.prototype.setNormalizedValue=function(t,e){if(this.contextObject){var r=this.options;if(r&&void 0!==r.min&&void 0!==r.max){if("multislider"===this.type){var a=this.contextObject[this.attributeName];if(e>=a.length)return;a[e]=r.min+t*(r.max-r.min),t=a}else if("color"===this.type){var o=this.contextObject[this.attributeName],s=i(o);if(0===e&&(s[0]=t),1===e&&(s[1]=t),2===e&&(s[2]=t),3===e&&(o[4]=t),3!==e){var c=n(s);o[0]=c[0],o[1]=c[1],o[2]=c[2]}t=o}else t=r.min+t*(r.max-r.min);r&&r.step&&(t-=t%r.step)}this.contextObject[this.attributeName]=t}},a.prototype.getSerializedValue=function(){return this.contextObject?this.contextObject[this.attributeName]:""},a.prototype.setSerializedValue=function(t){"slider"===this.type||"multislider"===this.type?this.contextObject[this.attributeName]=t:"color"===this.type?(this.contextObject[this.attributeName].r=t.r,this.contextObject[this.attributeName].g=t.g,this.contextObject[this.attributeName].b=t.b,this.contextObject[this.attributeName].a=t.a):("toggle"===this.type||"radiolist"===this.type)&&(this.contextObject[this.attributeName]=t)},a.prototype.getValue=function(){return"slider"===this.type||"multislider"===this.type||"color"===this.type||"toggle"===this.type?this.contextObject[this.attributeName]:0},a.prototype.getStrValue=function(){if("slider"===this.type){var t=""+this.contextObject[this.attributeName],e=t.indexOf(".")+1;if(0===e)return t+".0";for(;"0"===t.charAt(e);)e++;return t.substr(0,e+2)}return"color"===this.type?"HSLA":"toggle"===this.type?this.contextObject[this.attributeName]:""},t.exports=a},103:(t,e,r)=>{const i=r(8064),n=r(1922);function a(t,e){this._ctx=t,this.theme=e,this.canvas=document.createElement("canvas");const r=t.gl.drawingBufferWidth/3|0,i=t.gl.drawingBufferHeight/3|0;this.tex=t.texture2D({width:r,height:i,pixelFormat:t.PixelFormat.RGBA8,encoding:t.Encoding.SRGB}),this.canvas.width=r,this.canvas.height=i,this.ctx=this.canvas.getContext("2d"),this.dirty=!0}a.prototype.draw=function(t){function e(t,e){const r=document.createElement("canvas");r.width=c,r.height=c*e.height/e.width;const i=r.getContext("2d");i.drawImage(e,0,0,r.width,r.height),t.options.paletteImage=r,t.options.paletteImage.ctx=i,t.options.paletteImage.data=i.getImageData(0,0,r.width,r.height).data,t.dirty=!0}this.dirty=!1;const r=this._ctx.pixelRatio,a=this.ctx;a.save(),a.scale(1*r,1*r),a.clearRect(0,0,this.canvas.width,this.canvas.height),a.font=`${this.theme.fontSize} ${this.theme.fontFamily}`;let o=10,s=10,c=160,l=0,u=0,h=0;const f=t.filter((t=>"tab"===t.type)),d=f.length?41:10;for(let t=0;t<f.length;t++){const e=f[t];let r=30;a.fillStyle=this.theme.background,a.fillRect(s,o,c,r-2),a.fillStyle=e.current?this.theme.tabBackgroundActive:this.theme.tabBackground,a.fillRect(s+3,o+3,c-3-3,r-5-3),e.current||(a.fillStyle=this.theme.tabShadow,a.fillRect(s+3,o+r-6,c-6,3)),a.fillStyle=e.current?this.theme.tabColorActive:this.theme.tabColor,a.fillText(e.title,s+5,o+16),i.set4(e.activeArea,s+3,o+3,c-3-3,r-5-3),s+=c+3}s=10;let p=0,g=0,m=!0;for(let r=0;r<t.length;r++){const x=t[r];x.px&&x.px&&(s=x.px,o=x.py);let y=20;if("tab"!==x.type){if(f.length>0){const e=t.filter(((t,e)=>e<r&&"tab"===t.type)),i=e[e.length-1];if(i&&!i.current)continue;m&&"column"!==x.type&&(m=!1,o+=30),m=!1}if("column"!==x.type){if("slider"===x.type&&(y=34),"toggle"===x.type&&(y=20),"multislider"===x.type&&(y=20+14*x.getValue().length*1),"color"===x.type&&(y=20+14*(x.options.alpha?4:3)*1),"color"===x.type&&x.options.paletteImage&&(y+=1*(c*x.options.paletteImage.height/x.options.paletteImage.width+2)),"button"===x.type&&(y=24),"texture2D"===x.type&&(y=24+x.texture.height*c/x.texture.width),"textureCube"===x.type&&(y=24+c/2),"radiolist"===x.type&&(y=18+20*x.items.length*1),"texturelist"===x.type){const t=x.items[0].texture.width/x.items[0].texture.height;l=Math.floor((c-6)/x.itemsPerRow),u=Math.ceil(x.items.length/x.itemsPerRow),y=21+u*l/t}if("header"===x.type&&(y=26),"text"===x.type&&(y=45),"fps"===x.type&&(y=64),"stats"===x.type&&(y=94),"label"===x.type&&(y=18*x.title.split("\n").length*1),"separator"===x.type&&(y/=2),"separator"!==x.type&&(a.fillStyle=this.theme.background,a.fillRect(s,o,c,y-2)),x.options&&x.options.palette&&!x.options.paletteImage)if(x.options.palette.width)e(x,x.options.palette);else{const t=new window.Image;t.src=x.options.palette,t.onload=function(){e(x,t)}}if("slider"===x.type)a.fillStyle=this.theme.input,a.fillRect(s+3,o+18,c-3-3,y-5-18),a.fillStyle=this.theme.accent,a.fillRect(s+3,o+18,(c-3-3)*x.getNormalizedValue(),y-5-18),i.set4(x.activeArea,s+3,o+18,c-3-3,y-5-18),a.fillStyle=this.theme.color,a.fillText(t[r].title+" : "+x.getStrValue(),s+4,o+13);else if("multislider"===x.type){for(let t=0;t<x.getValue().length;t++)a.fillStyle=this.theme.input,a.fillRect(s+3,o+18+14*t*1,c-6,11),a.fillStyle=this.theme.accent,a.fillRect(s+3,o+18+14*t*1,(c-6)*x.getNormalizedValue(t),11);i.set4(x.activeArea,s+3,o+18,c-3-3,y-5-18),a.fillStyle=this.theme.color,a.fillText(t[r].title+" : "+x.getStrValue(),s+4,o+13)}else if("color"===x.type){const e=x.options.alpha?4:3;for(let t=0;t<e;t++)a.fillStyle=this.theme.input,a.fillRect(s+3,o+18+14*t*1,c-6,11),a.fillStyle=this.theme.accent,a.fillRect(s+3,o+18+14*t*1,(c-6)*x.getNormalizedValue(t),11);a.fillStyle="#"+(v=x.contextObject[x.attributeName],n(Math.floor(255*v[0]),Math.floor(255*v[1]),Math.floor(255*v[2]))),a.fillRect(s+c-12-3,o+3,12,12),x.options.paletteImage&&a.drawImage(x.options.paletteImage,s+3,o+18+14*e,c-6,c*x.options.paletteImage.height/x.options.paletteImage.width),a.fillStyle=this.theme.color,a.fillText(t[r].title+" : "+x.getStrValue(),s+4,o+13),i.set4(x.activeArea,s+3,o+18,c-3-3,y-5-18)}else if("button"===x.type){if(a.fillStyle=x.active?this.theme.accent:this.theme.input,a.fillRect(s+3,o+3,c-3-3,y-5-3),i.set4(x.activeArea,s+3,o+3,c-3-3,y-5-3),a.fillStyle=x.active?this.theme.colorActive:this.theme.color,a.fillText(t[r].title,s+5,o+15),x.options.color){const t=x.options.color;a.fillStyle="rgba("+255*t[0]+", "+255*t[1]+", "+255*t[2]+", 1)",a.fillRect(s+c-8,o+3,5,y-5-3)}}else if("toggle"===x.type){const e=x.contextObject[x.attributeName];a.fillStyle=e?this.theme.accent:this.theme.input,a.fillRect(s+3,o+3,y-5-3,y-5-3),i.set4(x.activeArea,s+3,o+3,y-5-3,y-5-3),a.fillStyle=this.theme.color,a.fillText(t[r].title,s+y,o+12)}else if("radiolist"===x.type){a.fillStyle=this.theme.color,a.fillText(x.title,s+4,o+13);const t=20;for(let e=0;e<x.items.length;e++){const r=x.items[e];let i=x.contextObject[x.attributeName]===r.value;a.fillStyle=i?this.theme.accent:this.theme.input,a.fillRect(s+3,18+e*t+o+3,t-5-3,t-5-3),a.fillStyle=this.theme.color,a.fillText(r.name,s+5+t-5,18+e*t+o+13)}i.set4(x.activeArea,s+3,18+o+3,t-5,x.items.length*t-5)}else if("texturelist"===x.type){a.fillStyle=this.theme.color,a.fillText(x.title,s+4,o+13);for(let t=0;t<x.items.length;t++){const e=t%x.itemsPerRow,r=Math.floor(t/x.itemsPerRow);let n=0;x.items[t].value===x.contextObject[x.attributeName]&&(a.fillStyle="none",a.strokeStyle=this.theme.accent,a.lineWidth="2",a.strokeRect(s+3+e*l+1,o+18+r*l+1,l-1-2,l-1-2),a.lineWidth="1",n=2),x.items[t].activeArea||(x.items[t].activeArea=[[0,0],[0,0]]),i.set4(x.items[t].activeArea,s+3+e*l+n,o+18+r*l+n,l-1-2*n,l-1-2*n)}i.set4(x.activeArea,s+3,18+o+3,c-3-3,l*u-5)}else if("texture2D"===x.type)a.fillStyle=this.theme.color,a.fillText(t[r].title,s+5,o+15),i.set4(x.activeArea,s+3,o+18,c-3-3,y-5-18);else if("textureCube"===x.type)a.fillStyle=this.theme.color,a.fillText(t[r].title,s+5,o+15),i.set4(x.activeArea,s+3,o+18,c-3-3,y-5-18);else if("header"===x.type)a.fillStyle=this.theme.headerBackground,a.fillRect(s+3,o+3,c-3-3,y-5-3),a.fillStyle=this.theme.headerColor,a.fillText(t[r].title,s+5,o+16);else if("text"===x.type)i.set4(x.activeArea,s+3,o+20,c-6,y-20-5),a.fillStyle=this.theme.color,a.fillText(t[r].title,s+3,o+13),a.fillStyle=this.theme.input,a.fillRect(s+3,o+20,x.activeArea[1][0]-x.activeArea[0][0],x.activeArea[1][1]-x.activeArea[0][1]),a.fillStyle=this.theme.color,a.fillText(x.contextObject[x.attributeName],s+3+3,o+15+20),x.focus&&(a.strokeStyle=this.theme.accent,a.strokeRect(x.activeArea[0][0]-.5,x.activeArea[0][1]-.5,x.activeArea[1][0]-x.activeArea[0][0],x.activeArea[1][1]-x.activeArea[0][1]));else if("fps"===x.type){x.values.length>c-6&&x.values.shift(),a.fillStyle=this.theme.graphBackground;const t=y-20-5;a.fillRect(s+3,o+20,c-6,t);let e=t-(x.values[0]||0)/60*t;a.beginPath(),a.moveTo(s+3,o+20+e);for(let r=0;r<x.values.length;r++)e=t-x.values[r]/60*t,a.lineTo(s+3+r,o+20+e);a.strokeStyle=this.theme.color,a.stroke(),a.fillStyle=this.theme.color,a.fillText(x.title+" : "+x.currentValue,s+5,o+13)}else"stats"===x.type?(a.fillStyle=this.theme.color,a.fillText(x.title,s+5,o+13),a.fillText("Buffers: "+x.bufferCount,s+5,o+13+18),a.fillText("Elements: "+x.elementsCount,s+5,o+13+36),a.fillText("FBOs: "+x.framebufferCount,s+5,o+13+54),a.fillText("Texture Mem: "+x.textureMemSize,s+5,o+13+72)):"separator"===x.type||("label"===x.type?(a.fillStyle=this.theme.color,t[r].title.split("\n").forEach(((t,e)=>{a.fillText(t,s+5,o+13+18*e)}))):(a.fillStyle=this.theme.color,a.fillText(t[r].title,s+5,o+13)));o+=y,p=Math.max(p,s+c),g=Math.max(g,o)}else s=10+h*(c+3),o=d,c=x.width,h++}}var v;a.restore(),this.updateTexture(),p=Math.max(p,f.length*(c+3)+13),p&&g&&(p=p*this._ctx.pixelRatio|0,g=g*this._ctx.pixelRatio|0,this.canvas.width!==p&&(this.canvas.width=p,this.dirty=!0),this.canvas.height!==g&&(this.canvas.height=g,this.dirty=!0),this.dirty&&this.draw(t))},a.prototype.getTexture=function(){return this.tex},a.prototype.getImageColor=function(t,e,r){return[t.data[4*(e+r*t.width)+0]/255,t.data[4*(e+r*t.width)+1]/255,t.data[4*(e+r*t.width)+2]/255]},a.prototype.updateTexture=function(){this._ctx.update(this.tex,{data:this.canvas,width:this.canvas.width,height:this.canvas.height,flipY:!0})},a.prototype.dispose=function(){this._ctx.dispose(this.tex),this.canvas.remove()},t.exports=a},5580:(t,e,r)=>{const i=r(4860),n=i.SkCanvas,a=i.SkPaint,o=i.SkPath,s=r(8064),c=t=>{let e=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/.exec(t);return e?[+e[1],+e[2],+e[3],Math.floor(255*+e[4])]:null};function l(t,e){const r=t.gl.drawingBufferWidth/3|0,i=t.gl.drawingBufferHeight/3|0;this.ctx=t,this.theme=e,this.tex=t.texture2D({width:r,height:i,pixelFormat:t.PixelFormat.RGBA8,encoding:t.Encoding.SRGB}),this.canvas=n.create(r,i),this.canvasPaint=new a,this.fontPaint=new a,this.fontPaint.setStyle(a.kFillStyle),this.fontPaint.setColor(...c(this.theme.color)),this.fontPaint.setTextSize(this.theme.fontSize),this.fontPaint.setFontFamily(this.theme.fontFamily),this.fontPaint.setStrokeWidth(0),this.linePaint=new a,this.linePaint.setColor(...c(this.theme.color)),this.linePaint.setStroke(),this.tabPaint=new a,this.headerFontPaint=new a,this.headerFontPaint.setStyle(a.kFillStyle),this.headerFontPaint.setColor(...c(this.theme.headerColor)),this.headerFontPaint.setTextSize(this.theme.fontSize),this.headerFontPaint.setFontFamily(this.theme.fontFamily),this.headerFontPaint.setStrokeWidth(0),this.fontHighlightPaint=new a,this.fontHighlightPaint.setStyle(a.kFillStyle),this.fontHighlightPaint.setColor(...c(this.theme.colorActive)),this.fontHighlightPaint.setTextSize(this.theme.fontSize),this.fontHighlightPaint.setFontFamily(this.theme.fontFamily),this.fontHighlightPaint.setStrokeWidth(0),this.panelBgPaint=new a,this.panelBgPaint.setStyle(a.kFillStyle),this.panelBgPaint.setColor(...c(this.theme.background)),this.headerBgPaint=new a,this.headerBgPaint.setStyle(a.kFillStyle),this.headerBgPaint.setColor(...c(this.theme.color)),this.textBgPaint=new a,this.textBgPaint.setStyle(a.kFillStyle),this.textBgPaint.setColor(...c(this.theme.input)),this.textBorderPaint=new a,this.textBorderPaint.setStyle(a.kStrokeStyle),this.textBorderPaint.setColor(...c(this.theme.accent)),this.controlBgPaint=new a,this.controlBgPaint.setStyle(a.kFillStyle),this.controlBgPaint.setColor(...c(this.theme.input)),this.controlHighlightPaint=new a,this.controlHighlightPaint.setStyle(a.kFillStyle),this.controlHighlightPaint.setColor(...c(this.theme.accent)),this.controlHighlightPaint.setAntiAlias(!0),this.controlStrokeHighlightPaint=new a,this.controlStrokeHighlightPaint.setStyle(a.kStrokeStyle),this.controlStrokeHighlightPaint.setColor(...c(this.theme.accent)),this.controlStrokeHighlightPaint.setAntiAlias(!1),this.controlStrokeHighlightPaint.setStrokeWidth(2),this.controlFeaturePaint=new a,this.controlFeaturePaint.setStyle(a.kFillStyle),this.controlFeaturePaint.setColor(...c(this.theme.color)),this.controlFeaturePaint.setAntiAlias(!0),this.imagePaint=new a,this.imagePaint.setStyle(a.kFillStyle),this.imagePaint.setColor(...c(this.theme.color)),this.colorPaint=new a,this.colorPaint.setStyle(a.kFillStyle),this.colorPaint.setColor(...c(this.theme.color)),this.dirty=!0}l.prototype.draw=function(t){this.dirty=!1;const e=this.canvas;e.save(),e.scale(1*this.ctx.pixelRatio,1*this.ctx.pixelRatio),e.drawColor(0,0,0,0,i.SkPaint.kClearMode);let r=10,a=10;const l=160;let u=0,h=0,f=0;const d=t.filter((t=>"tab"===t.type)),p=d.length?41:10;for(let t=0;t<d.length;t++){const i=d[t];let n=30;e.drawRect(this.panelBgPaint,a,r,a+l,r+n),i.current?this.tabPaint.setColor(...c(this.theme.tabBackgroundActive)):this.tabPaint.setColor(...c(this.theme.tabBackground)),e.drawRect(this.tabPaint,a+3,r+3,a+l-3,r+n-3),this.tabPaint.setColor(...c(this.theme.tabShadow)),e.drawRect(this.tabPaint,a+3,r+n-3,a+l-3,r+n-7),e.drawText(i.current?this.headerFontPaint:this.fontPaint,i.title,a+4+3,r+3+13),s.set4(i.activeArea,a+3,r+3,154,n-5-3),a+=163}a=10;let g=0,m=0,v=!0;for(let n=0;n<t.length;n++){const c=t[n];c.px&&c.px&&(a=c.px,r=c.py);let x=20;if("tab"!==c.type){if(d.length>0){const e=t.filter(((t,e)=>e<n&&"tab"===t.type)),i=e[e.length-1];if(i&&!i.current)continue;v&&"column"!==c.type&&(v=!1,r+=30),v=!1}if(c.options&&c.options.palette&&!c.options.paletteImage&&(c.options.palette.width?c.options.paletteImage=c.options.palette:c.options.paletteImage=i.SkCanvas.createFromImage(c.options.palette)),"column"!==c.type){if("slider"===c.type&&(x=34),"toggle"===c.type&&(x=20),"multislider"===c.type&&(x=20+14*c.getValue().length*1),"color"===c.type&&(x=20+14*(c.options.alpha?4:3)*1),"color"===c.type&&c.options.paletteImage&&(x+=1*(l*c.options.paletteImage.height/c.options.paletteImage.width+2)),"button"===c.type&&(x=24),"texture2D"===c.type&&(x=24+c.texture.height*l/c.texture.width),"textureCube"===c.type&&(x=104),"radiolist"===c.type&&(x=18+20*c.items.length*1),"texturelist"===c.type){const t=c.items[0].texture.width/c.items[0].texture.height;u=Math.floor(154/c.itemsPerRow),h=Math.ceil(c.items.length/c.itemsPerRow),x=21+h*u/t}if("header"===c.type&&(x=26),"text"===c.type&&(x=45),"fps"===c.type&&(x=64),"separator"===c.type&&(x/=2),"separator"!==c.type&&e.drawRect(this.panelBgPaint,a,r,a+l,r+x-2),"slider"===c.type)e.drawRect(this.controlBgPaint,a+3,r+18,a+l-3,r+x-5),e.drawRect(this.controlHighlightPaint,a+3,r+18,a+3+154*c.getNormalizedValue(),r+x-5),s.set4(c.activeArea,a+3,r+18,154,x-5-18),e.drawText(this.fontPaint,t[n].title+" : "+c.getStrValue(),a+4,r+13);else if("multislider"===c.type){for(let t=0;t<c.getValue().length;t++)e.drawRect(this.controlBgPaint,a+3,r+18+14*t*1,a+l-3,r+18+14*(t+1)*1-3),e.drawRect(this.controlHighlightPaint,a+3,r+18+14*t*1,a+3+154*c.getNormalizedValue(t),r+18+14*(t+1)*1-3);e.drawText(this.fontPaint,t[n].title+" : "+c.getStrValue(),a+4,r+13),s.set4(c.activeArea,a+4,r+18,154,x-5-18)}else if("color"===c.type){const i=c.options.alpha?4:3;for(let t=0;t<i;t++)e.drawRect(this.controlBgPaint,a+3,r+18+14*t*1,a+l-3,r+18+14*(t+1)*1-3),e.drawRect(this.controlHighlightPaint,a+3,r+18+14*t*1,a+3+154*c.getNormalizedValue(t),r+18+14*(t+1)*1-3);const o=c.getValue();this.colorPaint.setColor(255*o[0],255*o[1],255*o[2],255),e.drawRect(this.colorPaint,a+l-12-3,r+3,a+l-3,r+3+12),c.options.paletteImage&&e.drawCanvas(this.imagePaint,c.options.paletteImage,a+3,r+18+14*i,a+l-3,r+18+14*i+l*c.options.paletteImage.height/c.options.paletteImage.width),e.drawText(this.fontPaint,t[n].title+" : "+c.getStrValue(),a+3,r+13),s.set4(c.activeArea,a+4,r+18,154,x-5-18)}else if("button"===c.type){const i=c.active?this.controlHighlightPaint:this.controlBgPaint,o=c.active?this.fontHighlightPaint:this.fontPaint;if(e.drawRect(i,a+3,r+3,a+l-3,r+x-5),s.set4(c.activeArea,a+3,r+3,154,x-5),c.options.color){let t=c.options.color;this.controlFeaturePaint.setColor(255*t[0],255*t[1],255*t[2],255),e.drawRect(this.controlFeaturePaint,a+l-8,r+3,a+l-3,r+x-5)}e.drawText(o,t[n].title,a+5,r+15)}else if("toggle"===c.type){const i=c.contextObject[c.attributeName]?this.controlHighlightPaint:this.controlBgPaint;e.drawRect(i,a+3,r+3,a+x-5,r+x-5),s.set4(c.activeArea,a+3,r+3,x-5,x-5),e.drawText(this.fontPaint,t[n].title,a+x,r+13)}else if("radiolist"===c.type){e.drawText(this.fontPaint,c.title,a+4,r+14);const t=20;for(let i=0;i<c.items.length;i++){const n=c.items[i];let o=c.contextObject[c.attributeName]===n.value?this.controlHighlightPaint:this.controlBgPaint;e.drawRect(o,a+3,18+i*t+r+3,a+t-5,t+i*t+r+18-5),e.drawText(this.fontPaint,n.name,a+t,18+i*t+r+13)}s.set4(c.activeArea,a+3,18+r+3,t-5,c.items.length*t-5)}else if("texturelist"===c.type){e.drawText(this.fontPaint,c.title,a+4,r+14);for(let t=0;t<c.items.length;t++){const i=t%c.itemsPerRow,n=Math.floor(t/c.itemsPerRow);let o=this.controlBgPaint,l=0;if(e.drawRect(o,a+3+i*u,r+18+n*u,a+3+(i+1)*u-1,r+18+(n+1)*u-1),c.items[t].value===c.contextObject[c.attributeName]){const t=this.controlStrokeHighlightPaint;e.drawRect(t,a+3+i*u+1,r+18+n*u+1,a+3+(i+1)*u-1-1,r+18+(n+1)*u-1-1),l=2}c.items[t].activeArea||(c.items[t].activeArea=[[0,0],[0,0]]),s.set4(c.items[t].activeArea,a+3+i*u+l,r+18+n*u+l,u-1-2*l,u-1-2*l)}s.set4(c.activeArea,a+3,18+r+3,154,u*h-5)}else if("texture2D"===c.type)e.drawText(this.fontPaint,c.title,a+3,r+13),s.set4(c.activeArea,a+3,r+18,154,x-5-18);else if("textureCube"===c.type)e.drawText(this.fontPaint,c.title,a+3,r+13),s.set4(c.activeArea,a+3,r+18,154,x-5-18);else if("header"===c.type)e.drawRect(this.headerBgPaint,a+3,r+3,a+l-3,r+x-5),e.drawText(this.headerFontPaint,t[n].title,a+6,r+16);else if("fps"===c.type){c.values.length>154&&c.values.shift();const t=x-20-5;e.drawRect(this.textBgPaint,a+3,r+20,a+l-3,r+20+t);let i=t-(c.values[0]||0)/60*t,n=new o;n.moveTo(a+3,r+20+i);for(let e=0;e<c.values.length;e++)i=t-c.values[e]/60*t,n.lineTo(a+3+e,r+20+i);e.drawPath(this.linePaint,n),e.drawText(this.fontPaint,c.title+" : "+c.currentValue,a+6,r+16)}else"text"===c.type?(e.drawText(this.fontPaint,t[n].title,a+3,r+13),e.drawRect(this.textBgPaint,a+3,r+20,a+l-3,r+x-5),e.drawText(this.fontPaint,c.contextObject[c.attributeName],a+3+3,r+15+20),s.set4(c.activeArea,a+3,r+20,154,x-20-5),c.focus&&e.drawRect(this.textBorderPaint,c.activeArea[0][0],c.activeArea[0][1],c.activeArea[1][0],c.activeArea[1][1])):"separator"===c.type||e.drawText(this.fontPaint,t[n].title,a+3,r+13);r+=x,g=Math.max(g,a+l),m=Math.max(m,r)}else a=10+163*f,r=p,f++}}e.restore(),this.updateTexture(),g=Math.max(g,163*d.length+13),g&&m&&(g=g*this.ctx.pixelRatio|0,m=m*this.ctx.pixelRatio|0,g===this.canvas.width&&m===this.canvas.height||(this.canvas=n.create(g,m),this.dirty=!0,this.draw(t)))},l.prototype.getImageColor=function(t,e,r){const i=t.pixels||t;return[i[4*(e+r*t.width)+2]/255,i[4*(e+r*t.width)+1]/255,i[4*(e+r*t.width)+0]/255]},l.prototype.getTexture=function(){return this.tex},l.prototype.getCanvas=function(){return this.canvas},l.prototype.getCanvasPaint=function(){return this.canvasPaint},l.prototype.updateTexture=function(){if(!this.tex)return;const t=this.canvas.width*this.canvas.height*4;this.pixels&&this.pixels.length===t||(this.pixels=new Uint8Array(t));const e=this.pixels,r=this.canvas;for(let t=r.height-1;t>=0;t--)for(let i=0;i<r.width;i++){const n=4*(i+t*r.width);e[n]=r.pixels[n+2],e[n+1]=r.pixels[n+1],e[n+2]=r.pixels[n+0],e[n+3]=r.pixels[n+3]}this.ctx.update(this.tex,{data:e,width:this.canvas.width,height:this.canvas.height,flipY:!0})},l.prototype.dispose=function(){},t.exports=l},8583:(t,e,r)=>{"use strict";var i=r(7418);function n(t,e){if(t===e)return 0;for(var r=t.length,i=e.length,n=0,a=Math.min(r,i);n<a;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0}function a(t){return r.g.Buffer&&"function"==typeof r.g.Buffer.isBuffer?r.g.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var o=r(69),s=Object.prototype.hasOwnProperty,c=Array.prototype.slice,l="foo"===function(){}.name;function u(t){return Object.prototype.toString.call(t)}function h(t){return!a(t)&&"function"==typeof r.g.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var f=t.exports=x,d=/\s*function\s+([^\(\s]*)\s*/;function p(t){if(o.isFunction(t)){if(l)return t.name;var e=t.toString().match(d);return e&&e[1]}}function g(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function m(t){if(l||!o.isFunction(t))return o.inspect(t);var e=p(t);return"[Function"+(e?": "+e:"")+"]"}function v(t,e,r,i,n){throw new f.AssertionError({message:r,actual:t,expected:e,operator:i,stackStartFunction:n})}function x(t,e){t||v(t,!0,e,"==",f.ok)}function y(t,e,r,i){if(t===e)return!0;if(a(t)&&a(e))return 0===n(t,e);if(o.isDate(t)&&o.isDate(e))return t.getTime()===e.getTime();if(o.isRegExp(t)&&o.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(h(t)&&h(e)&&u(t)===u(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(a(t)!==a(e))return!1;var s=(i=i||{actual:[],expected:[]}).actual.indexOf(t);return-1!==s&&s===i.expected.indexOf(e)||(i.actual.push(t),i.expected.push(e),function(t,e,r,i){if(null==t||null==e)return!1;if(o.isPrimitive(t)||o.isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var n=b(t),a=b(e);if(n&&!a||!n&&a)return!1;if(n)return y(t=c.call(t),e=c.call(e),r);var s,l,u=A(t),h=A(e);if(u.length!==h.length)return!1;for(u.sort(),h.sort(),l=u.length-1;l>=0;l--)if(u[l]!==h[l])return!1;for(l=u.length-1;l>=0;l--)if(!y(t[s=u[l]],e[s],r,i))return!1;return!0}(t,e,r,i))}return r?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function w(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function E(t,e,r,i){var n;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(i=r,r=null),n=function(t){var e;try{t()}catch(t){e=t}return e}(e),i=(r&&r.name?" ("+r.name+").":".")+(i?" "+i:"."),t&&!n&&v(n,r,"Missing expected exception"+i);var a="string"==typeof i,s=!t&&n&&!r;if((!t&&o.isError(n)&&a&&w(n,r)||s)&&v(n,r,"Got unwanted exception"+i),t&&n&&r&&!w(n,r)||!t&&n)throw n}f.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=g(m(this.actual),128)+" "+this.operator+" "+g(m(this.expected),128),this.generatedMessage=!0);var e=t.stackStartFunction||v;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var r=new Error;if(r.stack){var i=r.stack,n=p(e),a=i.indexOf("\n"+n);if(a>=0){var o=i.indexOf("\n",a+1);i=i.substring(o+1)}this.stack=i}}},o.inherits(f.AssertionError,Error),f.fail=v,f.ok=x,f.equal=function(t,e,r){t!=e&&v(t,e,r,"==",f.equal)},f.notEqual=function(t,e,r){t==e&&v(t,e,r,"!=",f.notEqual)},f.deepEqual=function(t,e,r){y(t,e,!1)||v(t,e,r,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(t,e,r){y(t,e,!0)||v(t,e,r,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(t,e,r){y(t,e,!1)&&v(t,e,r,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function t(e,r,i){y(e,r,!0)&&v(e,r,i,"notDeepStrictEqual",t)},f.strictEqual=function(t,e,r){t!==e&&v(t,e,r,"===",f.strictEqual)},f.notStrictEqual=function(t,e,r){t===e&&v(t,e,r,"!==",f.notStrictEqual)},f.throws=function(t,e,r){E(!0,t,e,r)},f.doesNotThrow=function(t,e,r){E(!1,t,e,r)},f.ifError=function(t){if(t)throw t},f.strict=i((function t(e,r){e||v(e,!0,r,"==",t)}),f,{equal:f.strictEqual,deepEqual:f.deepStrictEqual,notEqual:f.notStrictEqual,notDeepEqual:f.notDeepStrictEqual}),f.strict.strict=f.strict;var A=Object.keys||function(t){var e=[];for(var r in t)s.call(t,r)&&e.push(r);return e}},6076:t=>{"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},2014:t=>{t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},69:(t,e,r)=>{var i=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(o(arguments[r]));return e.join(" ")}r=1;for(var n=arguments,a=n.length,s=String(t).replace(i,(function(t){if("%%"===t)return"%";if(r>=a)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}})),c=n[r];r<a;c=n[++r])p(c)||!y(c)?s+=" "+c:s+=" "+o(c);return s},e.deprecate=function(t,i){if(v(r.g.process))return function(){return e.deprecate(t,i).apply(this,arguments)};if(!0===process.noDeprecation)return t;var n=!1;return function(){if(!n){if(process.throwDeprecation)throw new Error(i);process.traceDeprecation?console.trace(i):console.error(i),n=!0}return t.apply(this,arguments)}};var n,a={};function o(t,r){var i={seen:[],stylize:c};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),d(r)?i.showHidden=r:r&&e._extend(i,r),v(i.showHidden)&&(i.showHidden=!1),v(i.depth)&&(i.depth=2),v(i.colors)&&(i.colors=!1),v(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=s),l(i,t,i.depth)}function s(t,e){var r=o.styles[e];return r?"["+o.colors[r][0]+"m"+t+"["+o.colors[r][1]+"m":t}function c(t,e){return t}function l(t,r,i){if(t.customInspect&&r&&E(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(i,t);return m(n)||(n=l(t,n,i)),n}var a=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(m(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return g(e)?t.stylize(""+e,"number"):d(e)?t.stylize(""+e,"boolean"):p(e)?t.stylize("null","null"):void 0}(t,r);if(a)return a;var o=Object.keys(r),s=function(t){var e={};return t.forEach((function(t,r){e[t]=!0})),e}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(r)),w(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return u(r);if(0===o.length){if(E(r)){var c=r.name?": "+r.name:"";return t.stylize("[Function"+c+"]","special")}if(x(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(b(r))return t.stylize(Date.prototype.toString.call(r),"date");if(w(r))return u(r)}var y,A="",T=!1,M=["{","}"];return f(r)&&(T=!0,M=["[","]"]),E(r)&&(A=" [Function"+(r.name?": "+r.name:"")+"]"),x(r)&&(A=" "+RegExp.prototype.toString.call(r)),b(r)&&(A=" "+Date.prototype.toUTCString.call(r)),w(r)&&(A=" "+u(r)),0!==o.length||T&&0!=r.length?i<0?x(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),y=T?function(t,e,r,i,n){for(var a=[],o=0,s=e.length;o<s;++o)S(e,String(o))?a.push(h(t,e,r,i,String(o),!0)):a.push("");return n.forEach((function(n){n.match(/^\d+$/)||a.push(h(t,e,r,i,n,!0))})),a}(t,r,i,s,o):o.map((function(e){return h(t,r,i,s,e,T)})),t.seen.pop(),function(t,e,r){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}(y,A,M)):M[0]+A+M[1]}function u(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,r,i,n,a){var o,s,c;if((c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]}).get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),S(i,n)||(o="["+n+"]"),s||(t.seen.indexOf(c.value)<0?(s=p(r)?l(t,c.value,null):l(t,c.value,r-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),v(o)){if(a&&n.match(/^\d+$/))return s;(o=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+s}function f(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function p(t){return null===t}function g(t){return"number"==typeof t}function m(t){return"string"==typeof t}function v(t){return void 0===t}function x(t){return y(t)&&"[object RegExp]"===A(t)}function y(t){return"object"==typeof t&&null!==t}function b(t){return y(t)&&"[object Date]"===A(t)}function w(t){return y(t)&&("[object Error]"===A(t)||t instanceof Error)}function E(t){return"function"==typeof t}function A(t){return Object.prototype.toString.call(t)}function T(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(v(n)&&(n=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(n)){var r=process.pid;a[t]=function(){var i=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,i)}}else a[t]=function(){};return a[t]},e.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=d,e.isNull=p,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=x,e.isObject=y,e.isDate=b,e.isError=w,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(2014);var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(){var t=new Date,e=[T(t.getHours()),T(t.getMinutes()),T(t.getSeconds())].join(":");return[t.getDate(),M[t.getMonth()],e].join(" ")}function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",P(),e.format.apply(e,arguments))},e.inherits=r(6076),e._extend=function(t,e){if(!e||!y(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t}},1227:(t,e,r)=>{function i(){var t;try{t=e.storage.debug}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t}(e=t.exports=r(1658)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),r){var i="color: "+this.color;t.splice(1,0,i,"color: inherit");var n=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(n++,"%c"===t&&(a=n))})),t.splice(a,0,i)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=i,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(i())},1658:(t,e,r)=>{var i;function n(t){function r(){if(r.enabled){var t=r,n=+new Date,a=n-(i||n);t.diff=a,t.prev=i,t.curr=n,i=n;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(r,i){if("%%"===r)return r;c++;var n=e.formatters[i];if("function"==typeof n){var a=o[c];r=n.call(t,a),o.splice(c,1),c--}return r})),e.formatArgs.call(t,o);var l=r.log||e.log||console.log.bind(console);l.apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var r,i=0;for(r in t)i=(i<<5)-i+t.charCodeAt(r),i|=0;return e.colors[Math.abs(i)%e.colors.length]}(t),"function"==typeof e.init&&e.init(r),r}(e=t.exports=n.debug=n.default=n).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];for(var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length,n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){var r,i;for(r=0,i=e.skips.length;r<i;r++)if(e.skips[r].test(t))return!1;for(r=0,i=e.names.length;r<i;r++)if(e.names[r].test(t))return!0;return!1},e.humanize=r(7824),e.names=[],e.skips=[],e.formatters={}},9075:t=>{t.exports=function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t]}},91:t=>{t.exports=function(t,e){var r=e[0],i=e[1],n=e[2],a=r*r+i*i+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t}},4703:t=>{t.exports=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}},8604:(t,e,r)=>{var i=r(4450),n=Math.PI,a=2*Math.PI;t.exports=function(t,e,r){return t=(t+a)%a,e=(e+a)%a,Math.abs(t-e)<n?i(t,e,r):t>e?i(t-=a,e,r):e>t?i(t,e-=a,r):void 0}},8033:t=>{t.exports=!0},4137:(t,e,r)=>{var i=r(313);t.exports=!!i.SkCanvas},864:t=>{t.exports=function(t,e,r){r=r||[0,0,0];const i=(e+90)/180*Math.PI,n=(90-t)/180*Math.PI;return r[0]=Math.sin(n)*Math.sin(i),r[1]=Math.cos(n),r[2]=Math.sin(n)*Math.cos(i),r}},4450:t=>{t.exports=function(t,e,r){return t*(1-r)+e*r}},675:t=>{var e={left:0,top:0};t.exports=function(t,r,i){r=r||t.currentTarget||t.srcElement,Array.isArray(i)||(i=[0,0]);var n,a=t.clientX||0,o=t.clientY||0,s=(n=r)===window||n===document||n===document.body?e:n.getBoundingClientRect();return i[0]=a-s.left,i[1]=o-s.top,i}},7824:t=>{var e=1e3,r=60*e,i=60*r,n=24*i;function a(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}t.exports=function(t,o){o=o||{};var s,c=typeof t;if("string"===c&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(a){var o=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*n;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(t);if("number"===c&&!1===isNaN(t))return o.long?a(s=t,n,"day")||a(s,i,"hour")||a(s,r,"minute")||a(s,e,"second")||s+" ms":function(t){return t>=n?Math.round(t/n)+"d":t>=i?Math.round(t/i)+"h":t>=r?Math.round(t/r)+"m":t>=e?Math.round(t/e)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},7418:t=>{"use strict";var e=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function n(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,a){for(var o,s,c=n(t),l=1;l<arguments.length;l++){for(var u in o=Object(arguments[l]))r.call(o,u)&&(c[u]=o[u]);if(e){s=e(o);for(var h=0;h<s.length;h++)i.call(o,s[h])&&(c[s[h]]=o[s[h]])}}return c}},75:function(t){(function(){var e,r,i,n,a,o;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(t.exports=function(){return(e()-a)/1e6},r=process.hrtime,n=(e=function(){var t;return 1e9*(t=r())[0]+t[1]})(),o=1e9*process.uptime(),a=n-o):Date.now?(t.exports=function(){return Date.now()-i},i=Date.now()):(t.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)},7128:(t,e,r)=>{t.exports={orbiter:r(4816),perspective:r(7869)}},4816:(t,e,r)=>{"use strict";const i=r(7441),n=r(3393),a=r(4430),o=r(9345).clamp,s=r(4087),c=r(8604),l=r(9345).lerp,u=r(9345).toRadians,h=r(9345).toDegrees,f=r(864),d=r(7798),p=r(675);function g(t,e){return t.touches?p(t.touches[0],e):p(t,e)}function m(t){const e={camera:t.camera,invViewMatrix:n.create(),dragging:!1,lat:0,minLat:-89.5,maxLat:89.5,lon:0,minLon:-1/0,maxLon:1/0,currentLat:0,currentLon:0,easing:1,element:t.element||window,width:0,height:0,clickPosWindow:[0,0],dragPos:[0,0,0],dragPosWindow:[0,0],distance:1,currentDistance:1,minDistance:1,maxDistance:1,zoomSlowdown:400,zoom:!0,pan:!0,drag:!0,dragSlowdown:4,clickTarget:[0,0,0],clickPosPlane:[0,0,0],dragPosPlane:[0,0,0],clickPosWorld:[0,0,0],dragPosWorld:[0,0,0],panPlane:null,autoUpdate:!0};this.set(e),this.set(t),this.setup()}m.prototype.set=function(t){if(t.camera){const e=i.distance(t.camera.position,t.camera.target),r=d(i.normalize(i.sub(i.copy(t.camera.position),t.camera.target)));this.lat=r[0],this.lon=r[1],this.currentLat=this.lat,this.currentLon=this.lon,this.distance=e,this.currentDistance=this.distance,this.minDistance=t.minDistance||e/10,this.maxDistance=t.maxDistance||10*e}Object.assign(this,t)},m.prototype.updateWindowSize=function(){const t=this.element.clientWidth||this.element.innerWidth,e=this.element.clientHeight||this.element.innerHeight;t!==this.width&&(this.width=t,this.height=e,this.radius=Math.min(this.width/2,this.height/2))},m.prototype.updateCamera=function(){if(!this.camera)return;const t=this.camera.position,e=this.camera.target;this.lat=o(this.lat,this.minLat,this.maxLat),this.lon=o(this.lon,this.minLon,this.maxLon)%360,this.currentLat=h(c((u(this.currentLat)+2*Math.PI)%(2*Math.PI),(u(this.lat)+2*Math.PI)%(2*Math.PI),this.easing)),this.currentLon=h(c((u(this.currentLon)+2*Math.PI)%(2*Math.PI),(u(this.lon)+2*Math.PI)%(2*Math.PI),this.easing)),this.currentDistance=l(this.currentDistance,this.distance,this.easing),f(this.currentLat,this.currentLon,t),i.scale(t,this.currentDistance),i.add(t,e),this.camera.set({position:t})},m.prototype.setup=function(){var t=this;function e(e){t.updateWindowSize();const r=g(e,t.element);!function(e,r,n){if(t.dragging=!0,t.dragPos[0]=e,t.dragPos[1]=r,n&&t.pan){t.clickPosWindow[0]=e,t.clickPosWindow[1]=r,i.set(t.clickTarget,t.camera.target);const n=i.multMat4(i.copy(t.clickTarget),t.camera.viewMatrix);t.panPlane=[n,[0,0,1]],a.hitTestPlane(t.camera.getViewRay(t.clickPosWindow[0],t.clickPosWindow[1],t.width,t.height),t.panPlane[0],t.panPlane[1],t.clickPosPlane),a.hitTestPlane(t.camera.getViewRay(t.dragPosWindow[0],t.dragPosWindow[1],t.width,t.height),t.panPlane[0],t.panPlane[1],t.dragPosPlane)}else t.panPlane=null}(r[0],r[1],e.shiftKey||e.touches&&2===e.touches.length)}function r(e){const r=g(e,t.element);!function(e,r,o){if(t.dragging)if(o&&t.panPlane){t.dragPosWindow[0]=e,t.dragPosWindow[1]=r,a.hitTestPlane(t.camera.getViewRay(t.clickPosWindow[0],t.clickPosWindow[1],t.width,t.height),t.panPlane[0],t.panPlane[1],t.clickPosPlane),a.hitTestPlane(t.camera.getViewRay(t.dragPosWindow[0],t.dragPosWindow[1],t.width,t.height),t.panPlane[0],t.panPlane[1],t.dragPosPlane),n.set(t.invViewMatrix,t.camera.viewMatrix),n.invert(t.invViewMatrix),i.multMat4(i.set(t.clickPosWorld,t.clickPosPlane),t.invViewMatrix),i.multMat4(i.set(t.dragPosWorld,t.dragPosPlane),t.invViewMatrix);const o=i.sub(i.copy(t.dragPosWorld),t.clickPosWorld),s=i.sub(i.copy(t.clickTarget),o);t.camera.set({target:s}),t.updateCamera()}else if(t.drag){const i=e-t.dragPos[0],n=r-t.dragPos[1];t.dragPos[0]=e,t.dragPos[1]=r,t.lat+=n/t.dragSlowdown,t.lon-=i/t.dragSlowdown,t.updateCamera()}}(r[0],r[1],e.shiftKey||e.touches&&2===e.touches.length)}function c(e){t.dragging=!1,t.panPlane=null}function l(e){if(1==(r=e.deltaY,!!t.zoom&&(t.distance*=1+r/t.zoomSlowdown,t.distance=o(t.distance,t.minDistance,t.maxDistance),t.updateCamera(),!0)))return e.preventDefault(),!1;var r}function u(t){t.preventDefault(),e(t)}if(this._onMouseDown=e,this._onTouchStart=u,this._onMouseMove=r,this._onMouseUp=c,this._onWheel=l,this.element.addEventListener("mousedown",e),this.element.addEventListener("touchstart",u),this.element.addEventListener("wheel",l),window.addEventListener("mousemove",r),window.addEventListener("touchmove",r,{passive:!1}),window.addEventListener("mouseup",c),window.addEventListener("touchend",c),this.updateCamera(),this.autoUpdate){const e=this;this._rafHandle=s((function r(){t.updateCamera(),e._rafHandle=s(r)}))}},m.prototype.dispose=function(){this.element.removeEventListener("mousedown",this._onMouseDown),this.element.removeEventListener("touchstart",this._onTouchStart),this.element.removeEventListener("wheel",this._onWheel),window.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("touchmove",this._onMouseMove),window.removeEventListener("mouseup",this._onMouseUp),window.removeEventListener("touchend",this._onMouseUp),s.cancel(this._rafHandle),this.camera=null},t.exports=function(t){return new m(t)}},7869:(t,e,r)=>{const i=r(7441),n=r(3393);function a(t){this.set({projectionMatrix:n.create(),invViewMatrix:n.create(),viewMatrix:n.create(),position:[0,0,3],target:[0,0,0],up:[0,1,0],fov:Math.PI/3,aspect:1,near:.1,far:100}),this.set(t)}a.prototype.set=function(t){Object.assign(this,t),(t.position||t.target||t.up)&&(n.lookAt(this.viewMatrix,this.position,this.target,this.up),n.set(this.invViewMatrix,this.viewMatrix),n.invert(this.invViewMatrix)),(t.fov||t.aspect||t.near||t.far)&&n.perspective(this.projectionMatrix,this.fov,this.aspect,this.near,this.far),this.frustum&&function(t,e,r,i,a,o,s){o=void 0===o?i:o,s=void 0===s?a:s;var c=t.near,l=t.far,u=t.fov,h=o/s,f=Math.tan(.5*u)*c,d=-f,p=h*d,g=h*f,m=Math.abs(g-p)/o,v=Math.abs(f-d)/s,x=p+e*m,y=p+(e+i)*m,b=f-(r+a)*v,w=f-r*v;t.aspect=h,n.frustum(t.projectionMatrix,x,y,b,w,c,l)}(this,this.frustum.offset[0],this.frustum.offset[1],this.frustum.size[0],this.frustum.size[1],this.frustum.totalSize[0],this.frustum.totalSize[1])},a.prototype.getViewRay=function(t,e,r,n){this.frustum&&(t+=this.frustum.offset[0],e+=this.frustum.offset[1],r=this.frustum.totalSize[0],n=this.frustum.totalSize[1]);let a=2*t/r-1,o=1-2*e/n,s=2*Math.tan(this.fov/2)*this.near;return a*=s*this.aspect*.5,o*=.5*s,[[0,0,0],i.normalize([a,o,-this.near])]},a.prototype.getWorldRay=function(t,e,r,n){let a=this.getViewRay(t,e,r,n),o=a[0],s=a[1];return i.multMat4(o,this.invViewMatrix),i.multMat4(s,this.invViewMatrix),i.normalize(i.sub(s,o)),a},t.exports=function(t){return new a(t)}},5130:(t,e,r)=>{const i=r(8583),n=r(1165),a=["target","data","usage","type","offset"];function o(t,e,r){n(a,r);const i=t.gl;let o=r.data||r,s=r.type||e.type,c=r.offset||0;if(Array.isArray(o)){s||(r.target===i.ARRAY_BUFFER&&(s=t.DataType.Float32),r.target===i.ELEMENT_ARRAY_BUFFER&&(s=t.DataType.Uint16));var l=o,u=Array.isArray(l[0])?l[0].length:1,h=u*l.length;if(s===t.DataType.Float32?o=new Float32Array(1===u?l:h):s===t.DataType.Uint8?o=new Uint8Array(1===u?l:h):s===t.DataType.Uint16?o=new Uint16Array(1===u?l:h):s===t.DataType.Uint32&&(o=new Uint32Array(1===u?l:h)),u>1)for(var f=0;f<l.length;f++)for(var d=0;d<u;d++)o[f*u+d]=l[f][d]}else if(o instanceof Float32Array)s=t.DataType.Float32;else if(o instanceof Uint8Array)s=t.DataType.Uint8;else if(o instanceof Uint16Array)s=t.DataType.Uint16;else if(o instanceof Uint32Array)s=t.DataType.Uint32;else if(!(o instanceof ArrayBuffer))throw new Error(`Unknown buffer data type: ${o.constructor}`);e.type=s,e.length=o.length,i.bindBuffer(e.target,e.handle),c?i.bufferSubData(e.target,c,o):i.bufferData(e.target,o,e.usage)}t.exports=function(t,e){const r=t.gl;n(a,e),i(e.target===r.ARRAY_BUFFER||e.target===r.ELEMENT_ARRAY_BUFFER,"Invalid buffer target");const s={class:e.target===r.ARRAY_BUFFER?"vertexBuffer":"indexBuffer",handle:r.createBuffer(),target:e.target,usage:e.usage||r.STATIC_DRAW,_update:o,_dispose:function(){r.deleteBuffer(this.handle),this.handle=null}};return o(t,s,e),s}},1165:t=>{t.exports=function(t,e){Object.keys(e).forEach((e=>{if(-1===t.indexOf(e))throw new Error(`Unknown prop "${e}"`)}))}},9989:(t,e,r)=>{const i=r(8583),n=r(1227)("context/framebuffer");function a(t,e,r){const a=t.gl;e.color=r.color.map((t=>{const e=t.texture?t:{texture:t};return e.level=0,e.target||(e.target=e.texture.target),e})),r.depth&&!r.depth.texture&&(r.depth={texture:r.depth}),e.depth=r.depth,e.width=e.color[0].texture.width,e.height=e.color[0].texture.height,a.bindFramebuffer(e.target,e.handle),e.drawBuffers.length=0;for(let t=0;t<e.color.length;t++){const r=e.color[t];e.drawBuffers.push(a.COLOR_ATTACHMENT0+t),a.framebufferTexture2D(e.target,a.COLOR_ATTACHMENT0+t,r.target,r.texture.handle,r.level)}for(let r=e.color.length;r<t.capabilities.maxColorAttachments;r++)a.framebufferTexture2D(e.target,a.COLOR_ATTACHMENT0+r,a.TEXTURE_2D,null,0);if(e.depth){t.debugMode&&n("fbo attaching depth",e.depth);const r=e.depth;r.texture.target===a.RENDERBUFFER?a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,r.texture.handle):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,r.texture.target,r.texture.handle,r.level)}else t.debugMode&&n("fbo deattaching depth"),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,null),a.framebufferTexture2D(e.target,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,null,0);var o=[];if(o[a.FRAMEBUFFER_COMPLETE]="FRAMEBUFFER_COMPLETE",o[a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",o[a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",o[a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",o[a.FRAMEBUFFER_UNSUPPORTED]="FRAMEBUFFER_UNSUPPORTED",t.debugMode){var s=a.checkFramebufferStatus(a.FRAMEBUFFER);i(s===a.FRAMEBUFFER_COMPLETE,`FBO incomplete ${o[s]}`)}a.bindFramebuffer(e.target,null)}t.exports=function(t,e){const r=t.gl,i={class:"framebuffer",handle:r.createFramebuffer(),target:r.FRAMEBUFFER,drawBuffers:[],color:[],depth:null,width:0,height:0,refCount:0,_update:a,_dispose:function(){r.deleteFramebuffer(this.handle),this.color=null,this.depth=null}};return(e.color||e.depth)&&a(t,i,e),i}},2765:(t,e,r)=>{const i=r(3415),n=r(8033),a=r(8583),o=r(4087),s=r(1227)("context"),c=r(7044),l=r(9989),u=r(6126),h=r(227),f=r(7530),d=r(7437),p=r(5130),g=r(8804),m=r(1165);let v=0;const x=["name","pass","pipeline","uniforms","attributes","indices","count","instances","viewport","scissor"];t.exports=function(t){a(!t||"object"==typeof t,"pex-context: createContext requires opts argument to be null or an object");let e=null;(t=Object.assign({},{pixelRatio:1},t)).pixelRatio&&(t=Object.assign(t,{pixelRatio:Math.min(t.pixelRatio,window.devicePixelRatio)})),t&&t.gl?t&&t.gl&&(e=t.gl):e=i(t),a(e,"pex-context: createContext failed");const r={maxColorAttachments:1,maxTextureImageUnits:e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubeMapTextureSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),instancedArrays:!1,instancing:!1,elementIndexUint32:!!e.getExtension("OES_element_index_uint"),standardDerivatives:!!e.getExtension("OES_standard_derivatives"),depthTexture:!!e.getExtension("WEBGL_depth_texture"),shaderTextureLod:!!e.getExtension("EXT_shader_texture_lod"),textureFloat:!!e.getExtension("OES_texture_float"),textureFloatLinear:!!e.getExtension("OES_texture_float_linear"),textureHalfFloat:!!e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:!!e.getExtension("OES_texture_half_float_linear"),textureFilterAnisotropic:!!e.getExtension("EXT_texture_filter_anisotropic")};if(!e.HALF_FLOAT){const t=e.getExtension("OES_texture_half_float");t&&(e.HALF_FLOAT=t.HALF_FLOAT_OES)}if(!e.createQuery){const t=e.getExtension("EXT_disjoint_timer_query");t?(e.TIME_ELAPSED=t.TIME_ELAPSED_EXT,e.QUERY_RESULT_AVAILABLE=t.QUERY_RESULT_AVAILABLE_EXT,e.GPU_DISJOINT=t.GPU_DISJOINT_EXT,e.QUERY_RESULT=t.QUERY_RESULT_EXT,e.createQuery=t.createQueryEXT.bind(t),e.deleteQuery=t.deleteQueryEXT.bind(t),e.beginQuery=t.beginQueryEXT.bind(t),e.endQuery=t.endQueryEXT.bind(t),e.getQueryObject=t.getQueryObjectEXT.bind(t)):(e.TIME_ELAPSED="TIME_ELAPSED",e.QUERY_RESULT_AVAILABLE="QUERY_RESULT_AVAILABLE",e.GPU_DISJOINT="GPU_DISJOINT",e.QUERY_RESULT="QUERY_RESULT",e.createQuery=function(){return{}},e.deleteQuery=function(){},e.beginQuery=function(){},e.endQuery=function(){},e.getQueryObject=function(t,r){return r===e.QUERY_RESULT_AVAILABLE||(r===e.QUERY_RESULT?0:void 0)})}const y={One:e.ONE,Zero:e.ZERO,SrcAlpha:e.SRC_ALPHA,OneMinusSrcAlpha:e.ONE_MINUS_SRC_ALPHA,DstAlpha:e.DST_ALPHA,OneMinusDstAlpha:e.ONE_MINUS_DST_ALPHA,SrcColor:e.SRC_COLOR,OneMinusSrcColor:e.ONE_MINUS_SRC_COLOR,DstColor:e.DST_COLOR,OneMinusDstColor:e.ONE_MINUS_DST_COLOR},b={PositiveX:e.TEXTURE_CUBE_MAP_POSITIVE_X,NegativeX:e.TEXTURE_CUBE_MAP_NEGATIVE_X,PositiveY:e.TEXTURE_CUBE_MAP_POSITIVE_Y,NegativeY:e.TEXTURE_CUBE_MAP_NEGATIVE_Y,PositiveZ:e.TEXTURE_CUBE_MAP_POSITIVE_Z,NegativeZ:e.TEXTURE_CUBE_MAP_NEGATIVE_Z},w={Never:e.NEVER,Less:e.LESS,Equal:e.EQUAL,LessEqual:e.LEQUAL,Greater:e.GREATER,NotEqual:e.NOTEQUAL,GreaterEqual:e.GEQUAL,Always:e.ALWAYS},E={Float32:e.FLOAT,Uint8:e.UNSIGNED_BYTE,Uint16:e.UNSIGNED_SHORT,Uint32:e.UNSIGNED_INT},A={Front:e.FRONT,Back:e.BACK,FrontAndBack:e.FRONT_AND_BACK},T={Nearest:e.NEAREST,Linear:e.LINEAR,NearestMipmapNearest:e.NEAREST_MIPMAP_NEAREST,NearestMipmapLinear:e.NEAREST_MIPMAP_LINEAR,LinearMipmapNearest:e.LINEAR_MIPMAP_NEAREST,LinearMipmapLinear:e.LINEAR_MIPMAP_LINEAR},M={Points:e.POINTS,Lines:e.LINES,LineStrip:e.LINE_STRIP,Triangles:e.TRIANGLES,TriangleStrip:e.TRIANGLE_STRIP},P={StaticDraw:e.STATIC_DRAW,DynamicDraw:e.DYNAMIC_DRAW,StreamDraw:e.STREAM_DRAW},S={ClampToEdge:e.CLAMP_TO_EDGE,Repeat:e.REPEAT},_={TimeElapsed:e.TIME_ELAPSED},C={gl:e,BlendFactor:y,CubemapFace:b,DataType:E,DepthFunc:w,Face:A,Filter:T,PixelFormat:{RGBA8:"rgba8",RGBA32F:"rgba32f",RGBA16F:"rgba16f",R32F:"r32f",R16F:"r16f",Depth:"depth",Depth16:"depth16",Depth24:"depth24"},Encoding:{Linear:1,Gamma:2,SRGB:3,RGBM:4},Primitive:M,Usage:P,Wrap:S,QueryTarget:_,QueryState:{Ready:"ready",Active:"active",Pending:"pending"}},R={pass:{framebuffer:{target:e.FRAMEBUFFER,handle:null,width:e.drawingBufferWidth,height:e.drawingBufferHeight},clearColor:[0,0,0,1],clearDepth:1},pipeline:f(C,{}),viewport:[0,0,e.drawingBufferWidth,e.drawingBufferHeight],scissor:null,count:0};if(e.drawElementsInstanced)r.instancedArrays=!0,r.instancing=!0;else{const t=e.getExtension("ANGLE_instanced_arrays");t?(e.drawElementsInstanced=t.drawElementsInstancedANGLE.bind(t),e.drawArraysInstanced=t.drawArraysInstancedANGLE.bind(t),e.vertexAttribDivisor=t.vertexAttribDivisorANGLE.bind(t),r.instancedArrays=!0,r.instancing=!0):(e.drawElementsInstanced=function(){throw new Error("gl.drawElementsInstanced not available. ANGLE_instanced_arrays not supported")},e.drawArraysInstanced=function(){throw new Error("gl.drawArraysInstanced not available. ANGLE_instanced_arrays not supported")},e.vertexAttribDivisor=function(){throw new Error("gl.vertexAttribDivisor not available. ANGLE_instanced_arrays not supported")})}if(e.drawBuffers)r.maxColorAttachments=e.getParameter("MAX_COLOR_ATTACHMENTS");else{const t=e.getExtension("WEBGL_draw_buffers");t?(e.drawBuffers=t.drawBuffersWEBGL.bind(t),r.maxColorAttachments=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL)):e.drawBuffers=function(){throw new Error("WEBGL_draw_buffers not supported")}}return s("capabilities",r),Object.assign(C,{debugMode:!1,capabilities:r,debugCommands:[],resources:[],stats:[],queries:[],stack:[R],defaultState:R,pixelRatio:t.pixelRatio||1,state:{pass:{framebuffer:R.pass.framebuffer},pipeline:f(C,{}),activeTextures:[],activeAttributes:[]},getGLString:function(t){let r="";for(let i in e)e[i]===t&&(r=i);return r||(r="UNDEFINED"),r},set:function(t){a(n,"changing resolution is not supported in Plask"),t.pixelRatio&&(this.updatePixelRatio=Math.min(t.pixelRatio,window.devicePixelRatio)),t.width&&(this.updateWidth=t.width),t.height&&(this.updateHeight=t.height)},debug:function(t){this.debugMode=t,t&&(this.debugCommands=[])},checkError:function(){if(this.debugMode){var t=e.getError();if(t)throw this.debugMode=!1,n&&s("State",this.state.state),new Error(`GL error ${t} : ${this.getGLString(t)}`)}},resource:function(t){return t.id=t.class+"_"+v++,this.stats[t.class]||(this.stats[t.class]={alive:0,total:0}),this.stats[t.class].alive++,this.stats[t.class].total++,this.resources.push(t),this.checkError(),t},texture2D:function(t){return s("texture2D",t),t.target=e.TEXTURE_2D,this.resource(c(this,t))},textureCube:function(t){return s("textureCube",t),t.target=e.TEXTURE_CUBE_MAP,this.resource(c(this,t))},framebuffer:function(t){return s("framebuffer",t),this.resource(l(this,t))},renderbuffer:function(t){return s("renderbuffer",t),this.resource(u(this,t))},vertexBuffer:function(t){return s("vertexBuffer",t),t.length&&(t={data:t}),t.target=e.ARRAY_BUFFER,this.resource(p(this,t))},indexBuffer:function(t){return s("indexBuffer",t),t.length&&(t={data:t}),t.target=e.ELEMENT_ARRAY_BUFFER,this.resource(p(this,t))},program:function(t){return s("program",t),this.resource(d(this,t))},pipeline:function(t){return s("pipeline",t),this.resource(f(this,t))},pass:function(t){return s("pass",t,t.color?t.color.map((t=>t.texture?t.texture.info:t.info)):""),this.resource(h(this,t))},query:function(t){return s("query",t),this.resource(g(this,t))},beginQuery:function(t){a(!this.activeQuery,"Only one query can be active at the time"),t._begin(this,t)&&(this.activeQuery=t)},endQuery:function(t){t._end(this,t)&&(this.queries.push(t),this.activeQuery=null)},readPixels:function(t){const r=t.x||0,i=t.y||0,n=t.width,a=t.height,o=e.RGBA,s=e.UNSIGNED_BYTE;let c=null;return c=new Uint8Array(n*a*4),e.readPixels(r,i,n,a,o,s,c),c},update:function(t,e){this.debugMode&&s("update",{resource:t,opts:e}),t._update(this,t,e)},mergeCommands:function(t,e,r){const i=Object.assign({},t);if(r||(i.pass=Object.assign({},t.pass),i.pass.clearColor=void 0,i.pass.clearDepth=void 0),Object.assign(i,e),!e.viewport&&e.pass&&e.pass.opts.color){let t=null;e.pass.opts.color[0]&&(t=e.pass.opts.color[0].texture||e.pass.opts.color[0]),e.pass.opts.depth&&(t=e.pass.opts.depth.texture||e.pass.opts.depth),t&&(i.viewport=[0,0,t.width,t.height])}return i.uniforms=t.uniforms||e.uniforms?Object.assign({},t.uniforms,e.uniforms):null,i},applyPass:function(t){const e=this.gl,r=this.state;r.pass.id!==t.id&&(this.debugMode&&s("change framebuffer",r.pass.framebuffer,"->",t.framebuffer),r.pass=t,t.framebuffer._update&&this.update(t.framebuffer,t.opts),e.bindFramebuffer(t.framebuffer.target,t.framebuffer.handle),t.framebuffer.drawBuffers&&t.framebuffer.drawBuffers.length>1&&e.drawBuffers(t.framebuffer.drawBuffers));let i=0;void 0!==t.clearColor&&(this.debugMode&&s("clearing color",t.clearColor),i|=e.COLOR_BUFFER_BIT,e.clearColor(t.clearColor[0],t.clearColor[1],t.clearColor[2],t.clearColor[3])),void 0!==t.clearDepth&&(this.debugMode&&s("clearing depth",t.clearDepth),i|=e.DEPTH_BUFFER_BIT,r.depthWrite||(r.depthWrite=!0,e.depthMask(!0)),e.clearDepth(t.clearDepth)),i&&e.clear(i),this.checkError()},applyPipeline:function(t){const e=this.gl,r=this.state;t.depthWrite!==r.depthWrite&&(r.depthWrite=t.depthWrite,e.depthMask(r.depthWrite)),t.depthTest!==r.depthTest&&(r.depthTest=t.depthTest,r.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST)),t.depthFunc!==r.depthFunc&&(r.depthFunc=t.depthFunc,e.depthFunc(r.depthFunc)),t.blend===r.blend&&t.blendSrcRGBFactor===r.blendSrcRGBFactor&&t.blendSrcAlphaFactor===r.blendSrcAlphaFactor&&t.blendDstRGBFactor===r.blendDstRGBFactor&&t.blendDstAlphaFactor===r.blendDstAlphaFactor||(r.blend=t.blend,r.blendSrcRGBFactor=t.blendSrcRGBFactor,r.blendSrcAlphaFactor=t.blendSrcAlphaFactor,r.blendDstRGBFactor=t.blendDstRGBFactor,r.blendDstAlphaFactor=t.blendDstAlphaFactor,r.blend?e.enable(e.BLEND):e.disable(e.BLEND),e.blendFuncSeparate(r.blendSrcRGBFactor,r.blendDstRGBFactor,r.blendSrcAlphaFactor,r.blendDstAlphaFactor)),t.cullFace===r.cullFace&&t.cullFaceMode===r.cullFaceMode||(r.cullFace=t.cullFace,r.cullFaceMode=t.cullFaceMode,r.cullFace?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),r.cullFace&&e.cullFace(r.cullFaceMode)),t.colorMask[0]===r.pipeline.colorMask[0]&&t.colorMask[1]===r.pipeline.colorMask[1]&&t.colorMask[2]===r.pipeline.colorMask[2]&&t.colorMask[3]===r.pipeline.colorMask[3]||(r.pipeline.colorMask[0]=t.colorMask[0],r.pipeline.colorMask[1]=t.colorMask[1],r.pipeline.colorMask[2]=t.colorMask[2],r.pipeline.colorMask[3]=t.colorMask[3],e.colorMask(t.colorMask[0],t.colorMask[1],t.colorMask[2],t.colorMask[3])),t.program!==r.program&&(r.program=t.program,r.program&&e.useProgram(r.program.handle)),t.vertexLayout&&(r.vertexLayout=t.vertexLayout),this.checkError()},applyUniforms:function(t,e){const r=this.gl,i=this.state;let n=0;i.program||a.fail("Trying to draw without an active program");const o=this.debugMode?Object.keys(i.program.uniforms):null;for(var c in t){let h=t[c];if(i.program.uniforms[c]||i.program.uniforms[c+"[0]"])if(null==h&&(s("invalid command",e),a.fail(`Can't set uniform "${c}" with a null value`)),Array.isArray(h)&&!i.program.uniforms[c]){this.debugMode&&s("unknown uniform",c,Object.keys(i.program.uniforms));for(var l=0;l<h.length;l++){var u=c+"["+l+"]";i.program.setUniform(u,h[l]),this.debugMode&&o.splice(o.indexOf(u),1)}}else if(h.target){const t=n++;r.activeTexture(r.TEXTURE0+t),i.activeTextures[t]!==h&&(r.bindTexture(h.target,h.handle),i.activeTextures[t]=h),i.program.setUniform(c,t),this.debugMode&&o.splice(o.indexOf(c),1)}else h.length||"object"!=typeof h?(i.program.setUniform(c,h),this.debugMode&&o.splice(o.indexOf(c),1)):(s("invalid command",e),a.fail(`Can set uniform "${c}" with an Object value`))}this.debugMode&&o.length>0&&(s("invalid command",e),a.fail(`Trying to draw with missing uniforms: ${o.join(", ")}`)),this.checkError()},drawVertexData:function(t){const i=this.state,n=i.vertexLayout;i.program||a.fail("Trying to draw without an active program"),this.debugMode&&n.length!==Object.keys(i.program.attributes).length&&(s("Invalid vertex layout not matching the shader",n,i.program.attributes,t),a.fail("Invalid vertex layout not matching the shader"));let o=!1;for(let t=0;t<16;t++)i.activeAttributes[t]=null,e.disableVertexAttribArray(t);for(let c=0;c<n.length;c++){const l=n[c],u=l[0],h=l[1],f=l[2],d=t.attributes[c]||t.attributes[u];d||(s("Invalid command",t,"doesn't satisfy vertex layout",n),a.fail(`Command is missing attribute "${u}" at location ${h} with ${d}`));let p=d.buffer;p||"vertexBuffer"!==d.class||(p=d),p&&p.target||(s("Invalid command",t),a.fail(`Trying to draw arrays with invalid buffer for attribute : ${u}`)),e.bindBuffer(p.target,p.handle),16===f?(e.enableVertexAttribArray(h+0),e.enableVertexAttribArray(h+1),e.enableVertexAttribArray(h+2),e.enableVertexAttribArray(h+3),i.activeAttributes[h+0]=p,i.activeAttributes[h+1]=p,i.activeAttributes[h+2]=p,i.activeAttributes[h+3]=p,e.vertexAttribPointer(h,4,d.type||p.type,d.normalized||!1,d.stride||64,d.offset||0),e.vertexAttribPointer(h+1,4,d.type||p.type,d.normalized||!1,d.stride||64,d.offset||16),e.vertexAttribPointer(h+2,4,d.type||p.type,d.normalized||!1,d.stride||64,d.offset||32),e.vertexAttribPointer(h+3,4,d.type||p.type,d.normalized||!1,d.stride||64,d.offset||48),d.divisor?(e.vertexAttribDivisor(h+0,d.divisor),e.vertexAttribDivisor(h+1,d.divisor),e.vertexAttribDivisor(h+2,d.divisor),e.vertexAttribDivisor(h+3,d.divisor),o=!0):r.instancing&&(e.vertexAttribDivisor(h+0,0),e.vertexAttribDivisor(h+1,0),e.vertexAttribDivisor(h+2,0),e.vertexAttribDivisor(h+3,0))):(e.enableVertexAttribArray(h),i.activeAttributes[h]=p,e.vertexAttribPointer(h,f,d.type||p.type,d.normalized||!1,d.stride||0,d.offset||0),d.divisor?(e.vertexAttribDivisor(h,d.divisor),o=!0):r.instancing&&e.vertexAttribDivisor(h,0))}let c=t.pipeline.primitive;if(t.indices){let r=t.indices.buffer;r||"indexBuffer"!==t.indices.class||(r=t.indices),r&&r.target||(s("Invalid command",t),a.fail("Trying to draw arrays with invalid buffer for elements")),i.indexBuffer=r,e.bindBuffer(r.target,r.handle);var l=t.count||r.length,u=t.indices.offset||0,h=t.indices.type||r.type;o?e.drawElementsInstanced(c,l,h,u,t.instances):e.drawElements(c,l,h,u)}else if(t.count){const r=0;o?e.drawArraysInstanced(c,r,t.count,t.instances):e.drawArrays(c,r,t.count)}else a.fail("Vertex arrays requres elements or count to draw");this.checkError()},frame:function(t){const r=this;o((function i(){r.updatePixelRatio&&(r.pixelRatio=r.updatePixelRatio,r.updateWidth||(r.updateWidth=parseInt(e.canvas.style.width)||e.canvas.width),r.updateHeight||(r.updateHeight=parseInt(e.canvas.style.height)||e.canvas.height),r.updatePixelRatio=0),r.updateWidth&&(e.canvas.style.width=r.updateWidth+"px",e.canvas.width=r.updateWidth*r.pixelRatio,r.updateWidth=0),r.updateHeight&&(e.canvas.style.height=r.updateHeight+"px",e.canvas.height=r.updateHeight*r.pixelRatio,r.updateHeight=0),r.defaultState.viewport[2]===e.drawingBufferWidth&&r.defaultState.viewport[3]===e.drawingBufferHeight||(r.defaultState.viewport[2]=e.drawingBufferWidth,r.defaultState.viewport[3]=e.drawingBufferHeight,r.defaultState.pass.framebuffer.width=e.drawingBufferWidth,r.defaultState.pass.framebuffer.height=e.drawingBufferHeight,e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight)),!1!==t()&&(r.queries.length&&(r.queries=r.queries.filter((t=>!t._available(r,t)))),o(i))}))},apply:function(t){const r=this.state;this.debugMode&&s("apply",t.name||t.id,{cmd:t,state:JSON.parse(JSON.stringify(r))}),this.checkError(),t.scissor?t.scissor!==r.scissor&&(r.scissor=t.scissor,e.enable(e.SCISSOR_TEST),e.scissor(r.scissor[0],r.scissor[1],r.scissor[2],r.scissor[3])):t.scissor!==r.scissor&&(r.scissor=t.scissor,e.disable(e.SCISSOR_TEST)),t.pass&&this.applyPass(t.pass),t.pipeline&&this.applyPipeline(t.pipeline),t.uniforms&&this.applyUniforms(t.uniforms),t.viewport&&t.viewport!==r.viewport&&(r.viewport=t.viewport,e.viewport(r.viewport[0],r.viewport[1],r.viewport[2],r.viewport[3])),t.attributes&&this.drawVertexData(t)},submit:function(t,e,r){if(this.debugMode&&(m(x,t),s("submit",t.name||t.id,e&&r?{depth:this.stack.length,cmd:t,batches:e,subCommand:r,state:this.state,stack:this.stack}:e?{depth:this.stack.length,cmd:t,batches:e,state:this.state,stack:this.stack}:{depth:this.stack.length,cmd:t,state:this.state,stack:this.stack})),e){if(Array.isArray(e)){for(let i=0;i<e.length;i++){const n=e[i];this.submit(this.mergeCommands(t,n,!0),r)}return}if("object"==typeof e)return void this.submit(this.mergeCommands(t,e,!0),r);r=e}const i=this.stack[this.stack.length-1],n=this.mergeCommands(i,t,!1);if(this.apply(n),this.debugMode&&(n.debugId=this.debugCommands.length,this.debugCommands.push({cmd:t,cmdState:n,parentState:i})),r){if(this.debugMode&&(this.debugGraph+=`subgraph cluster_${t.name||t.id} {\n`,this.debugGraph+=`label = "${t.name}"\n`,t.program&&(this.debugGraph+=`${t.program.id} -> cluster_${t.name||t.id}\n`),t.framebuffer)){this.debugGraph+=`${t.framebuffer.id} -> cluster_${t.name||t.id}\n`;for(let e=0;e<t.framebuffer.color;e++){const r=t.framebuffer.color[e];this.debugGraph+=`${r.texture.id} -> ${t.framebuffer.id}\n`}t.framebuffer.depth&&(this.debugGraph+=`${t.framebuffer.depth.texture.id} -> ${t.framebuffer.id}\n`)}this.stack.push(n),r(),this.stack.pop(),this.debugMode&&(this.debugGraph+="}\n")}this.checkError()},dispose:function(t){if(s("dispose",t),a(t||0===arguments.length,"Trying to dispose undefined resource"),t){t._dispose||a(t._dispose,"Trying to dispose non resource");const e=this.resources.indexOf(t);a(-1!==e,"Trying to dispose resource from another context"),this.resources.splice(e,1),this.stats[t.class].alive--,t._dispose()}else{for(;this.resources.length;)this.dispose(this.resources[0]);this.gl.canvas.width=1,this.gl.canvas.height=1}}}),C.apply(R),C}},227:(t,e,r)=>{const i=r(1165),n=["name","framebuffer","color","depth","clearColor","clearDepth"];t.exports=function(t,e){i(n,e);const r={class:"pass",opts:e,clearColor:e.clearColor,clearDepth:e.clearDepth,_dispose:function(){this.opts=null,this.clearColor=null,this.clearDepth=null,this.framebuffer===t.defaultState.pass.sharedFramebuffer&&0==--t.defaultState.pass.sharedFramebuffer.refCount&&(t.defaultState.pass.sharedFramebuffer._dispose(),t.defaultState.pass.sharedFramebuffer=null),this.framebuffer=null}};return(e.color||e.depth)&&(t.defaultState.pass.sharedFramebuffer||(t.defaultState.pass.sharedFramebuffer=t.framebuffer({})),r.framebuffer=t.defaultState.pass.sharedFramebuffer,t.defaultState.pass.sharedFramebuffer.refCount++),r.framebuffer||(r.framebuffer=t.defaultState.pass.framebuffer),r}},7530:(t,e,r)=>{const i=r(1165),n=["vert","frag","program","depthWrite","depthTest","depthFunc","blend","blendSrcRGBFactor","blendSrcAlphaFactor","blendDstRGBFactor","blendDstAlphaFactor","cullFace","cullFaceMode","colorMask","primitive"];t.exports=function(t,e){i(n,e);const r=Object.assign({class:"pipeline",vert:null,frag:null,program:null,depthWrite:!0,depthTest:!1,depthFunc:t.DepthFunc.LessEqual,blend:!1,blendSrcRGBFactor:t.BlendFactor.One,blendSrcAlphaFactor:t.BlendFactor.One,blendDstRGBFactor:t.BlendFactor.One,blendDstAlphaFactor:t.BlendFactor.One,cullFace:!1,cullFaceMode:t.Face.Back,colorMask:[!0,!0,!0,!0],primitive:t.Primitive.Triangles,_dispose:function(){this.vert=null,this.frag=null,this.program&&0==--this.program.refCount&&this.program.handle&&t.dispose(this.program),this.program=null}},e);if(e.vert&&e.frag&&(r.program=t.program({vert:e.vert,frag:e.frag})),r.program&&!r.vertexLayout){r.program.refCount++;const t=r.program.attributesPerLocation;r.vertexLayout=Object.keys(t).map((e=>{const r=t[e];return[r.name,parseInt(e,10),r.size]}))}return r}},7437:(t,e,r)=>{const i=r(1227)("context/program"),n=r(8583);function a(t,e,r){n("string"==typeof r.vert,"Vertex shader source must be a string"),n("string"==typeof r.frag,"Fragment shader source must be a string");const i=t.gl,a=o(t,0,i.VERTEX_SHADER,r.vert),s=o(t,0,i.FRAGMENT_SHADER,r.frag);if(i.attachShader(e.handle,a),i.attachShader(e.handle,s),i.linkProgram(e.handle),!i.getProgramParameter(e.handle,i.LINK_STATUS))throw new Error("Program: "+i.getProgramInfoLog(e.handle));i.deleteShader(a),i.deleteShader(s),function(t,e){const r=t.gl;e.uniforms={};const i=r.getProgramParameter(e.handle,r.ACTIVE_UNIFORMS);for(let n=0;n<i;++n){const i=r.getActiveUniform(e.handle,n),a=i.name;let o=0;switch(i.type){case r.INT:case r.BOOL:case r.FLOAT:o=1;break;case r.FLOAT_VEC2:o=2;break;case r.FLOAT_VEC3:o=3;break;case r.FLOAT_VEC4:case r.FLOAT_MAT2:o=4;break;case r.FLOAT_MAT3:o=9;break;case r.FLOAT_MAT4:o=16;break;case r.SAMPLER_2D:case r.SAMPLER_CUBE:o=0;break;default:throw new Error(`Unknwon attribute type ${i.type} : ${t.getGLString(i.type)}`)}if(e.uniforms[a]={name:a,type:i.type,size:o,location:r.getUniformLocation(e.handle,a)},i.size>1)for(let t=1;t<i.size;t++){const n=i.name.substr(0,i.name.indexOf("[")+1)+t+"]";e.uniforms[n]={type:i.type,location:r.getUniformLocation(e.handle,n)}}}}(t,e),function(t,e){const r=t.gl;e.attributes={},e.attributesPerLocation={};const i=r.getProgramParameter(e.handle,r.ACTIVE_ATTRIBUTES);for(let n=0;n<i;++n){const i=r.getActiveAttrib(e.handle,n),a=i.name;let o=0;switch(i.type){case r.FLOAT:o=1;break;case r.FLOAT_VEC2:o=2;break;case r.FLOAT_VEC3:o=3;break;case r.FLOAT_VEC4:o=4;break;case r.FLOAT_MAT4:o=16;break;default:throw new Error(`Unknwon attribute type ${i.type} : ${t.getGLString(i.type)}`)}const s={name:a,type:i.type,size:o,location:r.getAttribLocation(e.handle,a)};e.attributes[a]=s,e.attributesPerLocation[s.location]=s}}(t,e)}function o(t,e,r,n){const a=t.gl,o=a.createShader(r);if(a.shaderSource(o,n+"\n"),a.compileShader(o),!a.getShaderParameter(o,a.COMPILE_STATUS)){const t=r===a.VERTEX_SHADER?"Vertex":"Fragment";throw i(t+" shader compilation failed"),i(n),new Error(t+" shader error: "+a.getShaderInfoLog(o))}return o}t.exports=function(t,e){const r=t.gl,i={class:"program",handle:r.createProgram(),attributes:[],attributesPerLocation:{},uniforms:{},refCount:0,_update:a,_dispose:function(){r.deleteProgram(this.handle),this.handle=null,this.attributes=null,this.attributesPerLocation=null,this.uniforms=null},setUniform:function(e,r){const i=this.uniforms[e];if(void 0===i)throw new Error(`Uniform ${e} is not defined`);const n=t.gl,a=i.type,o=i.location;switch(i.type){case n.INT:case n.BOOL:n.uniform1i(o,r);break;case n.FLOAT:n.uniform1f(o,r);break;case n.FLOAT_VEC2:n.uniform2fv(o,r);break;case n.FLOAT_VEC3:n.uniform3fv(o,r);break;case n.FLOAT_VEC4:n.uniform4fv(o,r);break;case n.FLOAT_MAT2:n.uniformMatrix2fv(o,!1,r);break;case n.FLOAT_MAT3:n.uniformMatrix3fv(o,!1,r);break;case n.FLOAT_MAT4:n.uniformMatrix4fv(o,!1,r);break;case n.SAMPLER_2D:case n.SAMPLER_CUBE:n.uniform1i(o,r);break;default:throw new Error(`Invalid uniform type ${a} : ${t.getGLString(a)}`)}}};return a(t,i,e),i}},8804:(t,e,r)=>{const i=r(1165),n=["target"];function a(t,e){return e.state===t.QueryState.Ready&&(t.gl.beginQuery(e.target,e.handle),e.state=t.QueryState.Active,e.result=null,!0)}function o(t,e){return e.state===t.QueryState.Active&&(t.gl.endQuery(e.target),e.state=t.QueryState.Pending,!0)}function s(t,e){return!!t.gl.getQueryObject(e.handle,t.gl.QUERY_RESULT_AVAILABLE)&&(e.result=t.gl.getQueryObject(e.handle,t.gl.QUERY_RESULT),e.state=t.QueryState.Ready,!0)}t.exports=function(t,e){const r=t.gl;i(n,e=e||{});const c=Object.assign({class:"query",handle:r.createQuery(),target:null,state:t.QueryState.Ready,result:null,_begin:a,_end:o,_available:s,_dispose:function(){r.deleteQuery(this.handle),this.handle=null}},e);return c.target||(c.target=t.QueryTarget.TimeElapsed),c}},6126:(t,e,r)=>{const i=r(8583);function n(t,e,r){Object.assign(e,r);const n=t.gl;i(e.pixelFormat===t.PixelFormat.Depth16,"Only PixelFormat.Depth16 is supported for renderbuffers"),e.format=n.DEPTH_COMPONENT16,n.bindRenderbuffer(e.target,e.handle),n.renderbufferStorage(e.target,e.format,e.width,e.height),n.bindRenderbuffer(e.target,null)}t.exports=function(t,e){const r=t.gl,i={class:"renderbuffer",handle:r.createRenderbuffer(),target:r.RENDERBUFFER,width:0,height:0,_update:n,_dispose:function(){r.deleteRenderbuffer(this.handle),this.color=null,this.depth=null}};return n(t,i,e),i}},7044:(t,e,r)=>{const i=r(8583),n=r(1165),a=["name","data","width","height","pixelFormat","encoding","flipY","mipmap","target","min","mag","wrap","wrapS","wrapT","aniso","premultiplayAlpha"];function o(t,e){return void 0!==t?t:e}function s(t,e,r){const n=t.gl,a=t.PixelFormat;let s,c,l,u=null,h=r.width,f=r.height,d=o(r.flipY,o(e.flipY,!1)),p=r.target||e.target,g=r.pixelFormat||e.pixelFormat||t.PixelFormat.RGBA8,m=r.encoding||e.encoding||t.Encoding.Linear,v=r.min||e.min||n.NEAREST,x=r.mag||e.mag||n.NEAREST,y=r.wrapS||e.wrapS||r.wrap||e.wrap||n.CLAMP_TO_EDGE,b=r.wrapT||e.wrapT||r.wrap||e.wrap||n.CLAMP_TO_EDGE,w=r.aniso||e.aniso||0,E=o(r.premultiplayAlpha,o(e.premultiplayAlpha,!1));var A=n.getExtension("EXT_texture_filter_anisotropic");n.activeTexture(n.TEXTURE0+0),n.bindTexture(e.target,e.handle),t.state.activeTextures[0]=e,n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,d),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,E),n.texParameteri(p,n.TEXTURE_MAG_FILTER,x),n.texParameteri(p,n.TEXTURE_MIN_FILTER,v),n.texParameteri(p,n.TEXTURE_WRAP_S,y),n.texParameteri(p,n.TEXTURE_WRAP_T,b),A&&w>0&&n.texParameterf(p,A.TEXTURE_MAX_ANISOTROPY_EXT,w);const T=r.data?r.data:r;if(T&&T.nodeName)i(T instanceof window.HTMLImageElement||T instanceof window.HTMLVideoElement||T instanceof window.HTMLCanvasElement,"Texture2D.update opts has to be Image, Canvas or Video element"),h=T.width||T.videoHeight,f=T.height||T.videoHeight,s=n.RGBA,l=n.RGBA,c=n.UNSIGNED_BYTE,n.texImage2D(p,0,s,l,c,T),e.width=h,e.height=f;else if("object"==typeof r){if(i(!u||Array.isArray(r.data)||r.data instanceof Uint8Array||r.data instanceof Float32Array,"Texture2D.update opts.data has to be null or an Array, Uint8Array or Float32Array"),u=r.data?r.data.data||r.data:null,!r.width&&u&&u.width&&(h=u.width),!r.height&&u&&u.height&&(h=u.height),i(!u||void 0!==h&&void 0!==f,"Texture2D.update opts.width and opts.height are required when providing opts.data"),g===a.Depth||g===a.Depth16?(l=n.DEPTH_COMPONENT,s=n.DEPTH_COMPONENT,c=n.UNSIGNED_SHORT):g===a.Depth24?(l=n.DEPTH_COMPONENT,s=n.DEPTH_COMPONENT,c=n.UNSIGNED_INT):g===a.RGBA8?(l=n.RGBA,s=n.RGBA,c=n.UNSIGNED_BYTE):g===a.RGBA32F?(l=n.RGBA,s=n.RGBA,c=n.FLOAT):g===a.RGBA16F?(l=n.RGBA,s=n.RGBA,c=n.HALF_FLOAT):g===a.R32F?(l=n.ALPHA,s=n.ALPHA,c=n.FLOAT):g&&i.fail(`Unknown texture pixel format: ${r.format}`),p===n.TEXTURE_2D)Array.isArray(u)&&(c===n.UNSIGNED_BYTE?u=new Uint8Array(u):c===n.FLOAT||c===n.HALF_FLOAT?u=new Float32Array(u):i.fail(`Unknown texture data type: ${c}`)),h&&f&&(n.texImage2D(p,0,s,h,f,0,l,c,u),e.width=h,e.height=f);else if(p===n.TEXTURE_CUBE_MAP){i(!u||Array.isArray(u)&&6===u.length,"TextureCube requires data for 6 faces");for(let t=0;t<6;t++){let r=u?u[t].data||u[t]:null;const a=n.TEXTURE_CUBE_MAP_POSITIVE_X+t;Array.isArray(r)?(c===n.UNSIGNED_BYTE?r=new Uint8Array(r):c===n.FLOAT?r=new Float32Array(u):i.fail(`Unknown texture data type: ${c}`),n.texImage2D(a,0,s,h,f,0,l,c,r)):r&&r.nodeName?n.texImage2D(a,0,s,l,c,r):n.texImage2D(a,0,s,h,f,0,l,c,r),e.width=h,e.height=f}}}else i.fail("Texture2D.update opts has to be a HTMLElement or Object");return r.mipmap&&n.generateMipmap(e.target),e.target=p,e.pixelFormat=g,e.encoding=m,e.min=v,e.mag=x,e.wrapS=y,e.wrapT=b,e.format=l,e.flipY=d,e.internalFormat=s,e.type=c,e.info="",e.info+=Object.keys(t.PixelFormat).find((e=>t.PixelFormat[e]===g)),e.info+="_",e.info+=Object.keys(t.Encoding).find((e=>t.Encoding[e]===m)),e}t.exports=function(t,e){n(a,e);const r=t.gl,i={class:"texture",handle:r.createTexture(),target:e.target,width:0,height:0,_update:s,_dispose:function(){r.deleteTexture(this.handle),this.handle=null}};return s(t,i,e),i}},4430:(t,e,r)=>{var i=r(7441),n=i.create(),a=i.create(),o=i.create(),s=i.create(),c=i.create(),l=i.create(),u=i.create(),h=i.create(),f=1e-6;t.exports={create:function(){return[[0,0,0],[0,0,1]]},hitTestTriangle:function(t,e,r){var d=e[0],p=e[1],g=e[2],m=t[0],v=t[1],x=i.sub(i.set(n,p),d),y=i.sub(i.set(a,g),d),b=i.cross(i.set(o,x),y);if(i.length(b)<f)return-1;var w=i.sub(i.set(s,m),d),E=-i.dot(b,w),A=i.dot(b,v);if(Math.abs(A)<f)return 0===E?-2:-3;var T=E/A;if(T<-f)return-4;var M=i.add(i.set(c,m),i.scale(i.set(l,v),T)),P=i.dot(x,x),S=i.dot(x,y),_=i.dot(y,y),C=i.sub(i.set(u,M),d),R=i.dot(C,x),F=i.dot(C,y),O=S*S-P*_,L=(S*F-_*R)/O;if(L<-f||L>1.000001)return-5;var B=(S*R-P*F)/O;return B<-f||L+B>1.000001?-6:(r=void 0===r?i.create():r,i.set(r,x),i.scale(r,L),i.add(r,i.scale(i.set(h,y),B)),i.add(r,d),1)},hitTestPlane:function(t,e,r,s){var c=i.set(n,t[0]),l=i.set(a,t[1]);e=i.set(o,e);var u=i.dot(l,r);if(0===u)return-1;var h=i.dot(i.sub(e,c),r)/u;return h<0?-2:(s=void 0===s?i.create():s,i.set(s,i.add(c,i.scale(l,h))),1)},intersectsAABB:function(t,e){var r=t[0],i=t[1],n=1/i[0],a=1/i[1],o=1/i[2],s=e[0],c=e[1],l=s[0],u=s[1],h=s[2],f=c[0],d=c[1],p=c[2],g=(l-r[0])*n,m=(f-r[0])*n,v=(u-r[1])*a,x=(d-r[1])*a,y=(h-r[2])*o,b=(p-r[2])*o,w=Math.max(Math.max(Math.min(g,m),Math.min(v,x)),Math.min(y,b)),E=Math.min(Math.min(Math.max(g,m),Math.max(v,x)),Math.max(y,b));return!(E<0||w>E)}}},3415:(t,e,r)=>{const i=r(8583);t.exports=function(t){i(!t||"object"==typeof t,"pex-gl: createGL requires opts argument to be null or an object"),t||(t={});let e=t.canvas;const r=t.pixelRatio||1,n=!t.width&&!t.height;if(!e){if(e=document.createElement("canvas"),n){const t=document.createElement("meta");t.setAttribute("name","viewport"),t.setAttribute("content","width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0, shrink-to-fit=0.0"),document.head.appendChild(t)}const i=()=>{n&&(document.body.style.margin="0px",document.body.style.overflow="hidden",document.body.style.background="#000"),document.body.appendChild(e)},a=t.width||window.innerWidth,o=t.height||window.innerHeight;1!==r?(e.style.width=a+"px",e.style.height=o+"px",e.width=a*r,e.height=o*r):(e.width=a*r,e.height=o*r),document.body?i():document.addEventListener("DOMContentLoaded",i)}const a=["webgl","experimental-webgl"];for(var o=0;o<a.length;o++)try{const r=e.getContext(a[o],t);if(!r)throw new Error("Canvas.getContext returned null");return console.info("pex-gl","Creating",a[o],"succeeded"),r}catch(t){console.warn("pex-gl","Creating",a[o],"failed",t)}}},5021:(t,e,r)=>{t.exports={load:r(9901),loadBinary:r(9146),loadImage:r(4596),loadText:r(2718),loadJSON:r(4509)}},9901:(t,e,r)=>{var i=r(4596),n=r(9146),a=r(2718),o=r(4509),s=r(477);t.exports=s((function(t,e){var r={},s={},c=!1,l=0,u=Object.keys(t),h=u.length;function f(){try{c?e(s,null):e(null,r)}catch(t){console.log(t),console.log(t.stack)}}u.forEach((function(e){function u(t,i){t?(c=!0,s[e]=t):r[e]=i,++l===h&&f()}var d=t[e];d.image?i(d.image,u):d.text?a(d.text,u):d.json?o(d.json,u):d.binary?n(d.binary,u):u(new Error("pex-io/load unknown resource type "+Object.keys(d)),null)})),0===u.length&&f()}))},9146:(t,e,r)=>{var i=r(4137),n=r(9003),a=r(477);t.exports=a((function(t,e){i?function(t,e){try{if(!n.existsSync(t)&&e)return e(new Error("loadBinary error: File doesn\t exist"),null)}catch(t){return e(new Error("loadBinary error : "+t.toString()),null)}e(null,function(t){for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),i=0;i<t.length;++i)r[i]=t[i];return e}(n.readFileSync(t)))}(t,e):function(t,e){var r=new window.XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onreadystatechange=function(t){4===r.readyState&&(200===r.status?e(null,r.response):e(new Error("loadBinary error : "+r.response),null))},r.send(null)}(t,e)}))},4596:(t,e,r)=>{var i=r(4137),n=r(313),a=r(477);t.exports=a((function(t,e,r){i?function(t,e){var r;try{(r=n.SkCanvas.createFromImage(t)).data=function(t,e,r){for(var i=new Uint8Array(t*e*4),n=0;n<e;n++)for(var a=0;a<t;a++){var o=4*(a+n*t);i[o+0]=r[o+2],i[o+1]=r[o+1],i[o+2]=r[o+0],i[o+3]=r[o+3]}return i}(r.width,r.height,r.pixels)}catch(r){e(new Error(r+' "'+t+'"'),null)}e(null,r)}(t,e):function(t,e){var r=null,i=t;i.url&&(r=i.crossOrigin,i=i.url);var n=new window.Image;r&&(n.crossOrigin=r),n.onerror=function(){e(new Error("Failed to load "+i),null)},n.onload=function(){e(null,n)},n.src=i}(t,e)}))},4509:(t,e,r)=>{var i=r(2718),n=r(477);t.exports=n((function(t,e){i(t,(function(t,r){if(t)e(t,null);else{var i=null;try{i=JSON.parse(r)}catch(t){return e(t,null)}e(null,i)}}))}))},2718:(t,e,r)=>{var i=r(4137),n=r(9003),a=r(477);t.exports=a((function(t,e){i?function(t,e){if(!n.existsSync(t)&&e)return e(new Error("loadText error: File doesn't exist \""+t+'"'),null);var r=n.readFileSync(t,"utf8");e&&e(null,r)}(t,e):function(t,e){var r=new window.XMLHttpRequest;r.open("GET",t,!0),r.onreadystatechange=function(t){4===r.readyState&&(200===r.status?e&&e(null,r.responseText):e(new Error("loadText error: "+r.statusText),null))},r.send(null)}(t,e)}))},477:t=>{t.exports=function(t){return function(e,r){return r?t(e,r):new Promise(((r,i)=>{t(e,((t,e)=>{if(t)return i(t);r(e)}))}))}}},3729:(t,e,r)=>{t.exports={mat3:r(8256),mat4:r(3393),vec2:r(4876),vec3:r(7441),vec4:r(8712),quat:r(905),utils:r(9345)}},8256:t=>{t.exports={_set9:function(t,e,r,i,n,a,o,s,c,l){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=a,t[5]=o,t[6]=s,t[7]=c,t[8]=l,t},create:function(){return[1,0,0,0,1,0,0,0,1]},set:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},identity:function(t){return t[0]=t[4]=t[8]=1,t[1]=t[2]=t[3]=t[5]=t[6]=t[7]=0,t},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]},fromMat4:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},fromQuat:function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r+r,s=i+i,c=n+n,l=r*o,u=r*s,h=r*c,f=i*s,d=i*c,p=n*c,g=a*o,m=a*s,v=a*c;return t[0]=1-(f+p),t[3]=u-v,t[6]=h+m,t[1]=u+v,t[4]=1-(l+p),t[7]=d-g,t[2]=h-m,t[5]=d+g,t[8]=1-(l+f),t}}},3393:(t,e,r)=>{var i=r(8583);function n(t,e,r,i,n,a,o,s,c,l,u,h,f,d,p,g,m){var v=t[0],x=t[1],y=t[2],b=t[3],w=t[4],E=t[5],A=t[6],T=t[7],M=t[8],P=t[9],S=t[10],_=t[11],C=t[12],R=t[13],F=t[14],O=t[15];return t[0]=e*v+r*w+i*M+n*C,t[1]=e*x+r*E+i*P+n*R,t[2]=e*y+r*A+i*S+n*F,t[3]=e*b+r*T+i*_+n*O,t[4]=a*v+o*w+s*M+c*C,t[5]=a*x+o*E+s*P+c*R,t[6]=a*y+o*A+s*S+c*F,t[7]=a*b+o*T+s*_+c*O,t[8]=l*v+u*w+h*M+f*C,t[9]=l*x+u*E+h*P+f*R,t[10]=l*y+u*A+h*S+f*F,t[11]=l*b+u*T+h*_+f*O,t[12]=d*v+p*w+g*M+m*C,t[13]=d*x+p*E+g*P+m*R,t[14]=d*y+p*A+g*S+m*F,t[15]=d*b+p*T+g*_+m*O,t}function a(t,e,r,i){return n(t,e,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1)}function o(t,e,r,i){return n(t,1,0,0,0,0,1,0,0,0,0,1,0,e,r,i,1)}function s(t,e,r,i,a){var o,s,c,l,u,h,f,d,p,g,m,v,x,y,b,w,E,A,T,M,P=Math.sqrt(r*r+i*i+a*a);return P<1e-4?null:(r*=P=1/P,i*=P,a*=P,o=Math.sin(e),u=h=f=d=p=g=m=0,n(t,(l=1)*(v=r*r*(c=1-(s=Math.cos(e)))+s)+d*(x=i*r*c+a*o)+m*(y=a*r*c-i*o),u*v+1*x+0*y,h*v+p*x+1*y,f*v+g*x+0*y,l*(b=r*i*c-a*o)+d*(w=i*i*c+s)+m*(E=a*i*c+r*o),u*b+1*w+0*E,h*b+p*w+1*E,f*b+g*w+0*E,l*(A=r*a*c+i*o)+d*(T=i*a*c-r*o)+m*(M=a*a*c+s),u*A+1*T+0*M,h*A+p*T+1*M,f*A+g*T+0*M,0,0,0,1))}var c={_mult16:n,_scale3:a,_translate3:o,_rotate3:s,_lookAt9:function(t,e,r,i,n,a,o,s,c,l){var u,h,f,d,p,g,m,v,x,y;return Math.abs(e-n)<1e-6&&Math.abs(r-a)<1e-6&&Math.abs(i-o)<1e-6?(t[0]=1,t[1]=t[2]=t[3]=0,t[5]=1,t[4]=t[6]=t[7]=0,t[10]=1,t[8]=t[9]=t[11]=0,t[15]=1,t[12]=t[13]=t[14]=0,t):(m=e-n,v=r-a,x=i-o,u=c*(x*=y=1/Math.sqrt(m*m+v*v+x*x))-l*(v*=y),h=l*(m*=y)-s*x,f=s*v-c*m,(y=Math.sqrt(u*u+h*h+f*f))&&(u*=y=1/y,h*=y,f*=y),d=v*f-x*h,p=x*u-m*f,g=m*h-v*u,(y=Math.sqrt(d*d+p*p+g*g))&&(u*=y=1/y,h*=y,f*=y),t[0]=u,t[1]=d,t[2]=m,t[3]=0,t[4]=h,t[5]=p,t[6]=v,t[7]=0,t[8]=f,t[9]=g,t[10]=x,t[11]=0,t[12]=-(u*e+h*r+f*i),t[13]=-(d*e+p*r+g*i),t[14]=-(m*e+v*r+x*i),t[15]=1,t)},fromMat3:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[4]=e[3],t[5]=e[4],t[6]=e[5],t[8]=e[6],t[9]=e[7],t[10]=e[8],t[3]=t[7]=t[11]=t[12]=t[13]=t[14]=0,t[15]=1,t},fromQuat:function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],o=r+r,s=i+i,c=n+n,l=r*o,u=r*s,h=r*c,f=i*s,d=i*c,p=n*c,g=a*o,m=a*s,v=a*c;return t[0]=1-(f+p),t[4]=u-v,t[8]=h+m,t[1]=u+v,t[5]=1-(l+p),t[9]=d-g,t[2]=h-m,t[6]=d+g,t[10]=1-(l+f),t[3]=t[7]=t[11]=t[12]=t[13]=t[14]=0,t[15]=1,t},translate:function(t,e){return o(t,e[0],e[1],e[2])},scale:function(t,e){return a(t,e[0],e[1],e[2])},rotate:function(t,e,r){return s(t,e,r[0],r[1],r[2])},identity:function(t){return t[0]=t[5]=t[10]=t[15]=1,t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,t},mult:function(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8],h=t[9],f=t[10],d=t[11],p=t[12],g=t[13],m=t[14],v=t[15],x=e[0],y=e[1],b=e[2],w=e[3],E=e[4],A=e[5],T=e[6],M=e[7],P=e[8],S=e[9],_=e[10],C=e[11],R=e[12],F=e[13],O=e[14],L=e[15];return t[0]=x*r+y*o+b*u+w*p,t[1]=x*i+y*s+b*h+w*g,t[2]=x*n+y*c+b*f+w*m,t[3]=x*a+y*l+b*d+w*v,t[4]=E*r+A*o+T*u+M*p,t[5]=E*i+A*s+T*h+M*g,t[6]=E*n+A*c+T*f+M*m,t[7]=E*a+A*l+T*d+M*v,t[8]=P*r+S*o+_*u+C*p,t[9]=P*i+S*s+_*h+C*g,t[10]=P*n+S*c+_*f+C*m,t[11]=P*a+S*l+_*d+C*v,t[12]=R*r+F*o+O*u+L*p,t[13]=R*i+F*s+O*h+L*g,t[14]=R*n+F*c+O*f+L*m,t[15]=R*a+F*l+O*d+L*v,t},invert:function(t){var e=t[0],r=t[1],i=t[2],n=t[3],a=t[4],o=t[5],s=t[6],c=t[7],l=t[8],u=t[9],h=t[10],f=t[11],d=t[12],p=t[13],g=t[14],m=t[15];t[0]=o*h*m-o*f*g-u*s*m+u*c*g+p*s*f-p*c*h,t[4]=-a*h*m+a*f*g+l*s*m-l*c*g-d*s*f+d*c*h,t[8]=a*u*m-a*f*p-l*o*m+l*c*p+d*o*f-d*c*u,t[12]=-a*u*g+a*h*p+l*o*g-l*s*p-d*o*h+d*s*u,t[1]=-r*h*m+r*f*g+u*i*m-u*n*g-p*i*f+p*n*h,t[5]=e*h*m-e*f*g-l*i*m+l*n*g+d*i*f-d*n*h,t[9]=-e*u*m+e*f*p+l*r*m-l*n*p-d*r*f+d*n*u,t[13]=e*u*g-e*h*p-l*r*g+l*i*p+d*r*h-d*i*u,t[2]=r*s*m-r*c*g-o*i*m+o*n*g+p*i*c-p*n*s,t[6]=-e*s*m+e*c*g+a*i*m-a*n*g-d*i*c+d*n*s,t[10]=e*o*m-e*c*p-a*r*m+a*n*p+d*r*c-d*n*o,t[14]=-e*o*g+e*s*p+a*r*g-a*i*p-d*r*s+d*i*o,t[3]=-r*s*f+r*c*h+o*i*f-o*n*h-u*i*c+u*n*s,t[7]=e*s*f-e*c*h-a*i*f+a*n*h+l*i*c-l*n*s,t[11]=-e*o*f+e*c*u+a*r*f-a*n*u-l*r*c+l*n*o,t[15]=e*o*h-e*s*u-a*r*h+a*i*u+l*r*s-l*i*o;var v=e*t[0]+r*t[4]+i*t[8]+n*t[12];return 0===v?null:(v=1/v,t[0]*=v,t[1]*=v,t[2]*=v,t[3]*=v,t[4]*=v,t[5]*=v,t[6]*=v,t[7]*=v,t[8]*=v,t[9]*=v,t[10]*=v,t[11]*=v,t[12]*=v,t[13]*=v,t[14]*=v,t[15]*=v,t)},transpose:function(t){var e=t[1],r=t[2],i=t[3],n=t[6],a=t[7],o=t[8],s=t[9],c=t[11],l=t[12],u=t[13],h=t[14];return t[1]=t[4],t[2]=o,t[3]=l,t[4]=e,t[6]=s,t[7]=u,t[8]=r,t[9]=n,t[11]=h,t[12]=i,t[13]=a,t[14]=c,t},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},copy:function(t){return t.slice(0)},create:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},set:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},frustum:function(t,e,r,i,n,a,o){var s=1/(r-e),c=1/(n-i),l=1/(a-o),u=2*a;return t[0]=u*s,t[1]=t[2]=0,t[3]=0,t[4]=0,t[5]=u*c,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(n+i)*c,t[10]=(o+a)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*u*l,t[15]=0,t},perspective:function(t,e,r,n,a){i(e<Math.PI,"mat4.perpsective: vertical field of view should be in radians (0 to PI)");var o=1/Math.tan(.5*e),s=1/(n-a);return t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[12]=t[13]=t[15]=0,t[0]=o/r,t[5]=o,t[10]=(a+n)*s,t[11]=-1,t[14]=2*a*n*s,t},ortho:function(t,e,r,i,n,a,o){var s=e-r,c=i-n,l=a-o;return t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=0,t[0]=-2/s,t[5]=-2/c,t[10]=2/l,t[12]=(e+r)/s,t[13]=(n+i)/c,t[14]=(o+a)/l,t[15]=1,t},lookAt:function(t,e,r,i){var n,a,o,s,c,l,u,h,f,d,p=e[0],g=e[1],m=e[2],v=r[0],x=r[1],y=r[2],b=i[0],w=i[1],E=i[2];return Math.abs(p-v)<1e-6&&Math.abs(g-x)<1e-6&&Math.abs(m-y)<1e-6?(t[0]=1,t[1]=t[2]=t[3]=0,t[5]=1,t[4]=t[6]=t[7]=0,t[10]=1,t[8]=t[9]=t[11]=0,t[15]=1,t[12]=t[13]=t[14]=0,t):(u=p-v,h=g-x,f=m-y,n=w*(f*=d=1/Math.sqrt(u*u+h*h+f*f))-E*(h*=d),a=E*(u*=d)-b*f,o=b*h-w*u,(d=Math.sqrt(n*n+a*a+o*o))&&(n*=d=1/d,a*=d,o*=d),s=h*o-f*a,c=f*n-u*o,l=u*a-h*n,(d=Math.sqrt(s*s+c*c+l*l))&&(n*=d=1/d,a*=d,o*=d),t[0]=n,t[1]=s,t[2]=u,t[3]=0,t[4]=a,t[5]=c,t[6]=h,t[7]=0,t[8]=o,t[9]=l,t[10]=f,t[11]=0,t[12]=-(n*p+a*g+o*m),t[13]=-(s*p+c*g+l*m),t[14]=-(u*p+h*g+f*m),t[15]=1,t)}};t.exports=c},905:(t,e,r)=>{var i=r(8583),n=r(7441),a=Math.pow(2,-24);function o(t){var e=t[0],r=t[1],i=t[2],n=t[3];return Math.sqrt(e*e+r*r+i*i+n*n)}function s(t){var e=o(t);return e>a&&(e=1/e,t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e),t}function c(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function l(t,e,r,i,n,a,o,s,c,l){var u,h=e+a+l;return h>=0?(u=Math.sqrt(h+1),t[3]=.5*u,u=.5/u,t[0]=(o-c)*u,t[1]=(s-i)*u,t[2]=(r-n)*u):e>a&&e>l?(u=Math.sqrt(1+e-a-l),t[0]=.5*u,u=.5/u,t[1]=(r+n)*u,t[2]=(s+i)*u,t[3]=(o-c)*u):a>l?(u=Math.sqrt(1+a-e-l),t[1]=.5*u,u=.5/u,t[0]=(r+n)*u,t[2]=(o+c)*u,t[3]=(s-i)*u):(u=Math.sqrt(1+l-e-a),t[2]=.5*u,u=.5/u,t[0]=(s+i)*u,t[1]=(o+c)*u,t[3]=(r-n)*u),t}var u,h=(u=[],function(t,e,r){return u=n.cross(n.set(u,e),r),t[0]=u[0],t[1]=u[1],t[2]=u[2],t[3]=1+n.dot(e,r),s(t),t}),f={create:function(){return[0,0,0,1]},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},identity:function(t){return t[0]=t[1]=t[2]=0,t[3]=1,t},copy:function(t){return t.slice(0)},set:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},mult:function(t,e){var r=t[0],i=t[1],n=t[2],a=t[3],o=e[0],s=e[1],c=e[2],l=e[3];return t[0]=a*o+r*l+i*c-n*s,t[1]=a*s+i*l+n*o-r*c,t[2]=a*c+n*l+r*s-i*o,t[3]=a*l-r*o-i*s-n*c,t},invert:function(t){var e=c(t,t);return e=e?1/e:0,t[0]*=-e,t[1]*=-e,t[2]*=-e,t[3]*=e,t},conjugate:function(t){return t[0]*=-1,t[1]*=-1,t[2]*=-1,t},dot:c,length:o,normalize:s,setAxisAngle:function(t,e,r){i(void 0!==e.length,"quat.setAxisAngle: axis should be vec3");var n=.5*r,a=Math.sin(n);return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=Math.cos(n),s(t)},setAxes:function(t,e,r,i){return l(t,e[0],e[1],e[2],r[0],r[1],r[2],i[0],i[1],i[2])},fromMat3:function(t,e){return l(t,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},fromMat4:function(t,e){return l(t,e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10])},getAngle:function(t){return 2*Math.acos(t[3])},setEuler:function(t,e,r,i){r*=.5,e*=.5,i*=.5;var n=Math.sin(r),a=Math.cos(r),o=Math.sin(e),s=Math.cos(e),c=Math.sin(i),l=Math.cos(i),u=a*s,h=n*o;return t[0]=c*u-l*h,t[1]=l*n*s+c*a*o,t[2]=l*a*o-c*n*s,t[3]=l*u+c*h,t},slerp:function(t,e,r){var i,n,a,o,s,l=t[0],u=t[1],h=t[2],f=t[3],d=e[0],p=e[1],g=e[2],m=e[3];return(n=c(t,e))<0?(n=-n,t[0]=-d,t[1]=-p,t[2]=-g,t[3]=-m):(t[0]=d,t[1]=p,t[2]=g,t[3]=m),1-n>1e-6?(i=Math.acos(n),a=Math.sin(i),o=Math.sin((1-r)*i)/a,s=Math.sin(r*i)/a):(o=1-r,s=r),t[0]=o*l+s*t[0],t[1]=o*u+s*t[1],t[2]=o*h+s*t[2],t[3]=o*f+s*t[3],t},fromTo:h};t.exports=f},9345:t=>{function e(t,e,r){return Math.max(e,Math.min(t,r))}var r={lerp:function(t,e,r){return t+(e-t)*r},clamp:e,smoothstep:function(t,r,i){return(t=e((t-r)/(i-r),0,1))*t*(3-2*t)},map:function(t,e,r,i,n){return i+(n-i)*(t-e)/(r-e)},toRadians:function(t){return t*Math.PI/180},toDegrees:function(t){return 180*t/Math.PI},sign:function(t){return t/Math.abs(t)},isPowerOfTwo:function(t){return 0==(t&t-1)},nextPowerOfTwo:function(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16))}};t.exports=r},4876:t=>{var e={create:function(){return[0,0]},set:function(t,e){return t[0]=e[0],t[1]=e[1],t},copy:function(t){return t.slice(0)},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]},add:function(t,e){return t[0]+=e[0],t[1]+=e[1],t},addScaled:function(t,e,r){return t[0]+=e[0]*r,t[1]+=e[1]*r,t},sub:function(t,e){return t[0]-=e[0],t[1]-=e[1],t},scale:function(t,e){return t[0]*=e,t[1]*=e,t},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]},length:function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},lengthSq:function(t){var e=t[0],r=t[1];return e*e+r*r},normalize:function(t){var e=t[0],r=t[1],i=Math.sqrt(e*e+r*r);return i=1/(i||1),t[0]*=i,t[1]*=i,t},distance:function(t,e){var r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)},distanceSq:function(t,e){var r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i},limit:function(t,e){var r=t[0],i=t[1],n=r*r+i*i,a=e*e;if(a>0&&n>a){var o=e/Math.sqrt(n);t[0]*=o,t[1]*=o}return t},lerp:function(t,e,r){var i=t[0],n=t[1];return t[0]=i+(e[0]-i)*r,t[1]=n+(e[1]-n)*r,t},toString:function(t,e){var r=Math.pow(10,void 0!==e?e:4),i="[";return(i+=Math.floor(t[0]*r)/r+", ")+(Math.floor(t[1]*r)/r+"]")}};t.exports=e},7441:t=>{var e={create:function(){return[0,0,0]},set:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},copy:function(t){return t.slice(0)},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},add:function(t,e){return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t},addScaled:function(t,e,r){return t[0]+=e[0]*r,t[1]+=e[1]*r,t[2]+=e[2]*r,t},sub:function(t,e){return t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],t},scale:function(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t},multMat4:function(t,e){var r=t[0],i=t[1],n=t[2];return t[0]=e[0]*r+e[4]*i+e[8]*n+e[12],t[1]=e[1]*r+e[5]*i+e[9]*n+e[13],t[2]=e[2]*r+e[6]*i+e[10]*n+e[14],t},multQuat:function(t,e){var r=t[0],i=t[1],n=t[2],a=e[0],o=e[1],s=e[2],c=e[3],l=c*r+o*n-s*i,u=c*i+s*r-a*n,h=c*n+a*i-o*r,f=-a*r-o*i-s*n;return t[0]=l*c+f*-a+u*-s-h*-o,t[1]=u*c+f*-o+h*-a-l*-s,t[2]=h*c+f*-s+l*-o-u*-a,t},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},cross:function(t,e){var r=t[0],i=t[1],n=t[2],a=e[0],o=e[1],s=e[2];return t[0]=i*s-o*n,t[1]=n*a-s*r,t[2]=r*o-a*i,t},length:function(t){var e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)},lengthSq:function(t){var e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i},normalize:function(t){var e=t[0],r=t[1],i=t[2],n=Math.sqrt(e*e+r*r+i*i);return n=1/(n||1),t[0]*=n,t[1]*=n,t[2]*=n,t},distance:function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(r*r+i*i+n*n)},distanceSq:function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return r*r+i*i+n*n},limit:function(t,e){var r=t[0],i=t[1],n=t[2],a=r*r+i*i+n*n,o=e*e;if(o>0&&a>o){var s=e/Math.sqrt(a);t[0]*=s,t[1]*=s,t[2]*=s}return t},lerp:function(t,e,r){var i=t[0],n=t[1],a=t[2];return t[0]=i+(e[0]-i)*r,t[1]=n+(e[1]-n)*r,t[2]=a+(e[2]-a)*r,t},toString:function(t,e){var r=Math.pow(10,void 0!==e?e:4),i="[";return i+=Math.floor(t[0]*r)/r+", ",(i+=Math.floor(t[1]*r)/r+", ")+(Math.floor(t[2]*r)/r+"]")}};t.exports=e},8712:t=>{t.exports={create:function(){return[0,0,0,1]},set:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},fromVec3:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=1,t},multMat4:function(t,e){var r=t[0],i=t[1],n=t[2],a=t[3];return t[0]=e[0]*r+e[4]*i+e[8]*n+e[12]*a,t[1]=e[1]*r+e[5]*i+e[9]*n+e[13]*a,t[2]=e[2]*r+e[6]*i+e[10]*n+e[14]*a,t[3]=e[3]*r+e[7]*i+e[11]*n+e[15]*a,t},copy:function(t){return t.slice(0)},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}}},313:t=>{t.exports={}},5858:t=>{t.exports=function(t,e,r,i,n,a){void 0===t&&(t=1),void 0===e&&(e=t),void 0===r&&(r=t),void 0===i&&(i=1),void 0===n&&(n=i),void 0===a&&(a=i);var o=0,s=[],c=[],l=[],u=[];function h(t,e,r,i,n,a,h,f,d,p){for(var g=o,m=0;m<=h;m++)for(var v=0;v<=a;v++){var x=s[o]=[0,0,0];x[t]=(-i/2+v*i/a)*d,x[e]=(-n/2+m*n/h)*p,x[r]=f;var y=c[o]=[0,0,0];y[t]=0,y[e]=0,y[r]=f/Math.abs(f);var b=l[o]=[0,0];b[0]=v/a,b[1]=1-m/h,++o}for(m=0;m<h;m++)for(v=0;v<a;v++){var w=g+m*(a+1)+v;u.push([w,w+a+1,w+a+2]),u.push([w,w+a+2,w+1])}}return h(0,1,2,t,e,i,n,r/2,1,-1),h(0,1,2,t,e,i,n,-r/2,-1,-1),h(2,1,0,r,e,a,n,-t/2,1,-1),h(2,1,0,r,e,a,n,t/2,-1,-1),h(0,2,1,t,r,i,a,e/2,1,1),h(0,2,1,t,r,i,a,-e/2,1,-1),{positions:s,normals:c,uvs:l,cells:u}}},7919:(t,e,r)=>{var i=r(9075),n=r(4703),a=r(91);t.exports=function(t){for(var e=i((t=t||{}).majorRadius,1),r=i(t.minorRadius,.25),o=i(t.minorSegments,32),s=i(t.majorSegments,64),c=i(t.arc,2*Math.PI),l=2*Math.PI,u=[0,0,0],h=[],f=[],d=[],p=[0,0,0],g=[],m=0;m<=o;m++)for(var v=0;v<=s;v++){var x=v/s*c,y=m/o*l;u[0]=e*Math.cos(x),u[1]=e*Math.sin(x);var b=[(e+r*Math.cos(y))*Math.cos(x),(e+r*Math.cos(y))*Math.sin(x),r*Math.sin(y)];f.push(b),n(p,b,u),a(p,p),g.push(p.slice()),h.push([v/s,m/o])}for(m=1;m<=o;m++)for(v=1;v<=s;v++){var w=(s+1)*m+v-1,E=(s+1)*(m-1)+v-1,A=(s+1)*(m-1)+v,T=(s+1)*m+v;d.push([w,E,T]),d.push([E,A,T])}return{uvs:h,cells:d,normals:g,positions:f}}},4087:(t,e,r)=>{for(var i=r(75),n="undefined"==typeof window?r.g:window,a=["moz","webkit"],o="AnimationFrame",s=n["request"+o],c=n["cancel"+o]||n["cancelRequest"+o],l=0;!s&&l<a.length;l++)s=n[a[l]+"Request"+o],c=n[a[l]+"Cancel"+o]||n[a[l]+"CancelRequest"+o];if(!s||!c){var u=0,h=0,f=[];s=function(t){if(0===f.length){var e=i(),r=Math.max(0,16.666666666666668-(e-u));u=r+e,setTimeout((function(){var t=f.slice(0);f.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(u)}catch(t){setTimeout((function(){throw t}),0)}}),Math.round(r))}return f.push({handle:++h,callback:t,cancelled:!1}),h},c=function(t){for(var e=0;e<f.length;e++)f[e].handle===t&&(f[e].cancelled=!0)}}t.exports=function(t){return s.call(n,t)},t.exports.cancel=function(){c.apply(n,arguments)},t.exports.polyfill=function(t){t||(t=n),t.requestAnimationFrame=s,t.cancelAnimationFrame=c}},7798:t=>{t.exports=function(t,e){return(e=e||[0,0])[0]=90-Math.acos(t[1])/Math.PI*180,e[1]=-Math.atan2(t[2],t[0])/Math.PI*180,e}},6270:(t,e,r)=>{const i=r(8365);t.exports=function(t,e){return new i(t,e)}},2240:t=>{t.exports=function(t){var e,r,i,n,a,o=t[0],s=t[1],c=t[2];if(0===s)return[a=c,a,a];e=2*c-(r=c<.5?c*(1+s):c+s-c*s),n=[0,0,0];for(var l=0;l<3;l++)(i=o+1/3*-(l-1))<0&&i++,i>1&&i--,a=6*i<1?e+6*(r-e)*i:2*i<1?r:3*i<2?e+(r-e)*(2/3-i)*6:e,n[l]=a;return n}},8204:t=>{t.exports=function(t){var e,r,i=t[0],n=t[1],a=t[2],o=Math.min(i,n,a),s=Math.max(i,n,a),c=s-o;return s===o?e=0:i===s?e=(n-a)/c:n===s?e=2+(a-i)/c:a===s&&(e=4+(i-n)/c),(e=Math.min(60*e,360))<0&&(e+=360),r=(o+s)/2,[e/360,s===o?0:r<=.5?c/(s+o):c/(2-s-o),r]}},2278:(t,e,r)=>{var i=r(9612);t.exports=!!i.SkCanvas},9612:t=>{t.exports={}},8495:(t,e,r)=>{var i,n;!function(){var a,o={polyfill:function(){if(!("KeyboardEvent"in window)||"key"in KeyboardEvent.prototype)return!1;var t={get:function(t){var e=o.keys[this.which||this.keyCode];return Array.isArray(e)&&(e=e[+this.shiftKey]),e}};return Object.defineProperty(KeyboardEvent.prototype,"key",t),t},keys:{3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],91:"OS",93:"ContextMenu",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"}};for(a=1;a<25;a++)o.keys[111+a]="F"+a;var s="";for(a=65;a<91;a++)s=String.fromCharCode(a),o.keys[a]=[s.toLowerCase(),s.toUpperCase()];void 0===(n="function"==typeof(i=o)?i.call(e,r,e,t):i)||(t.exports=n)}()},8064:t=>{function e(t,e){return void 0===e?[t[0][0],t[0][1]]:(e[0]=t[0][0],e[1]=t[0][1],e)}function r(t,e){return void 0===e?[t[1][0],t[1][1]]:(e[0]=t[1][0],e[1]=t[1][1],e)}function i(t){return t[1][0]-t[0][0]}function n(t){return t[1][1]-t[0][1]}function a(t,e,r){return t[0][0]=e,t[0][1]=r,t[1][0]=e+i(t),t[1][1]=r+n(t),t}function o(t,e,r){return e>=t[0][0]&&e<=t[1][0]&&r>=t[0][1]&&r<=t[1][1]}function s(t,e){return c(t,e[0],e[1])}function c(t,e,r){var i=t[0][0],n=t[0][1],a=t[1][0],o=t[1][1];return t[0][0]=i>e?e:i,t[0][1]=n>r?r:n,t[1][0]=a<e?e:a,t[1][1]=o<r?r:o,t}function l(t,e){for(var r,i,n=t[0][0],a=t[0][1],o=t[1][0],s=t[1][1],c=0,l=e.length;c<l;++c)n=n>(r=e[c][0])?r:n,a=a>(i=e[c][1])?i:a,o=o<r?r:o,s=s<i?i:s;return t[0][0]=n,t[0][1]=a,t[1][0]=o,t[1][1]=s,t}function u(t,e){for(var r,i,n=t[0][0],a=t[0][1],o=t[1][0],s=t[1][1],c=0,l=e.length;c<l;c+=2)n=n>(r=e[c])?r:n,a=a>(i=e[c+1])?i:a,o=o<r?r:o,s=s<i?i:s;return t[0][0]=n,t[0][1]=a,t[1][0]=o,t[1][1]=s,t}function h(t,e){return s(t,e[0]),s(t,e[1]),t}function f(t,e){for(var r=0,i=e.length;r<i;++r)h(t,e[r]);return t}var d={create:function(){return[[1/0,1/0],[-1/0,-1/0]]},zero:function(){return[[0,0],[0,0]]},copy:function(t){return[t[0].slice(0),t[1].slice()]},set:function(t,e){return t[0][0]=e[0][0],t[0][1]=e[0][1],t[1][0]=e[1][0],t[1][1]=e[1][1],t},set4:function(t,e,r,i,n){return t[0][0]=e,t[0][1]=r,t[1][0]=e+i,t[1][1]=r+n,t},scale:function(t,e){return t[0][0]*=e,t[0][1]*=e,t[1][0]*=e,t[1][1]*=e,t},setMinMax:function(t,e,r){return t[0][0]=e[0],t[0][1]=e[1],t[1][0]=r[0],t[1][1]=r[1],t},setMinMax4:function(t,e,r,i,n){return t[0][0]=e,t[0][1]=r,t[1][0]=i,t[1][1]=n,t},getMin:e,getMax:r,setSize2:function(t,e,r){return t[1][0]=t[0][0]+e,t[1][1]=t[0][1]+r,t},setSize:function(t,e){return t[1][0]=t[0][0]+e[0],t[1][1]=t[0][1]+e[1],t},getSize:function(t,e){var r=i(t),a=n(t);return void 0===e?[r,a]:(e[0]=r,e[1]=a,e)},setWidth:function(t,e){return t[1][0]=t[0][0]+e,t},getWidth:i,setHeight:function(t,e){return t[1][1]=t[0][1]+e,t},getHeight:n,getAspectRatio:function(t){return i(t)/n(t)},setPosition:function(t,e){return a(t,e[0],e[1])},setPosition2:a,getPosition:e,getTL:e,getTR:function(t,e){return void 0===e?[t[1][0],t[1]]:(e[0]=t[1][0],e[1]=t[0][1],e)},getBL:function(t,e){return void 0===e?[t[0][0],t[1][1]]:(e[0]=t[0][0],e[1]=t[1][1],e)},getBR:r,getCenter:function(t,e){var r=.5*i(t),a=.5*n(t);return void 0===e?[r,a]:(e[0]=r,e[1]=a,e)},containsPoint:function(t,e){return o(t,e[0],e[1])},containsPoint2:o,containsRect:function(t,e){return o(t,e[0][0],e[0][1])&&o(t,e[1][0],e[1][1])},includePoint:s,includePoint2:c,includePoints:l,includePointsFlat:u,includeRect:h,includeRects:f,mapPoint:function(t,e){var r=t[0][0],i=t[0][1],n=t[1][0],a=t[1][1],o=e[0],s=e[1];return e[0]=Math.max(r,Math.min(o,n))-r,e[1]=Math.max(i,Math.min(s,a))-i,e},clampPoint:function(t,e){var r=t[0][0],i=t[0][1],n=t[1][0],a=t[1][1];return e[0]=Math.max(r,Math.min(e[0],n)),e[1]=Math.max(i,Math.min(e[1],a)),e},isZero:function(t){return 0==t[0][0]&&0==t[0][1]&&0==t[1][0]&&0==t[1][1]},isEmpty:function(t){return t[0][0]>t[1][0]||t[0][1]>t[1][1]},setEmpty:function(t){return t[0][0]=t[0][1]=1/0,t[1][0]=t[1][1]=-1/0,t},toMax:function(t){t[0][0]=t[1][0]=-Number.MAX_VALUE,t[0][1]=t[1][1]=Number.MAX_VALUE},setZero:function(t){return t[0][0]=t[0][1]=t[1][0]=t[1][1]=0,t},createFromPoints:function(t){return l([[1/0,1/0],[-1/0,-1/0]],t)},createFromPointsFlat:function(t){return u([[1/0,1/0],[-1/0,-1/0]],t)},createFromRects:function(t){return f([[1/0,1/0],[-1/0,-1/0]],t)}};t.exports=d},2829:t=>{function e(){this._start=0,this._now=0,this._prev=0,this._delta=0,this._deltaSeconds=0,this._elapsedSeconds=0,this._frames=-1,this._stopped=!1,this._fpsUpdateFrequency=1e3,this._fpsFrames=0,this._fpsTime=0,this._fps=0}e.prototype._update=function(t){this._prev=this._now,this._now=t,this._delta=this._now-this._prev,this._deltaSeconds=this._delta/1e3,this._elapsedSeconds=(this._now-this._start)/1e3,this._frames++,this._fpsTime>this._fpsUpdateFrequency?(this._fps=Math.floor(this._fpsFrames/(this._fpsTime/1e3)*10)/10,this._fpsTime=0,this._fpsFrames=0):(this._fpsTime+=this._delta,this._fpsFrames++)},e.prototype._stop=function(){this._stopped=!0,this._delta=0,this._deltaSeconds=0,this._fpsFrames=0,this._fpsTime=0,this._fps=0},e.prototype._restart=function(t){t=t||0,this._start=t,this._now=t,this._prev=t,this._delta=0,this._frames=0,this._stopped=!1,this._deltaSeconds=0,this._elapsedSeconds=0,this._fpsFrames=0,this._fpsTime=0,this._fps=0},e.prototype._resume=function(t){this._now=t,this._prev=t,this._delta=0,this._stopped=!1,this._fpsFrames=0,this._fpsTime=0,this._fps=0},e.prototype.getDelta=function(){return this._delta},e.prototype.getDeltaSeconds=function(){return this._deltaSeconds},e.prototype.getElapsedSeconds=function(){return this._elapsedSeconds},e.prototype.getElapsedFrames=function(){return this._frames},e.prototype.getFPS=function(){return this._fps},t.exports=e},4860:t=>{t.exports={}},1922:t=>{"use strict";t.exports=(t,e,r,i)=>{const n=(t+(i||"")).toString().includes("%");if("string"==typeof t){const n=t.match(/(0?\.?\d{1,3})%?\b/g).map(Number);t=n[0],e=n[1],r=n[2],i=n[3]}else void 0!==i&&(i=parseFloat(i));if("number"!=typeof t||"number"!=typeof e||"number"!=typeof r||t>255||e>255||r>255)throw new TypeError("Expected three numbers below 256");if("number"==typeof i){if(!n&&i>=0&&i<=1)i=Math.round(255*i);else{if(!(n&&i>=0&&i<=100))throw new TypeError(`Expected alpha value (${i}) as a fraction or percentage`);i=Math.round(255*i/100)}i=(256|i).toString(16).slice(1)}else i="";return(r|e<<8|t<<16|1<<24).toString(16).slice(1)+i}},2563:t=>{t.exports="\n#define LINEAR 1\n#define GAMMA 2\n#define SRGB 3\n#define RGBM 4\n\nvec4 decode(vec4 pixel, int encoding) {\n  if (encoding == LINEAR) return pixel;\n  if (encoding == GAMMA) return toLinear(pixel);\n  if (encoding == SRGB) return toLinear(pixel);\n  if (encoding == RGBM) return vec4(decodeRGBM(pixel), 1.0);\n  return pixel;\n}\n\nvec4 encode(vec4 pixel, int encoding) {\n  if (encoding == LINEAR) return pixel;\n  if (encoding == GAMMA) return toGamma(pixel);\n  if (encoding == SRGB) return toGamma(pixel);\n  if (encoding == RGBM) return encodeRGBM(pixel.rgb);\n  return pixel;\n}\n"},5354:t=>{t.exports="\nconst float gamma = 2.2;\n\n// Linear\nfloat toLinear(float v) {\n  return pow(v, gamma);\n}\n\nvec2 toLinear(vec2 v) {\n  return pow(v, vec2(gamma));\n}\n\nvec3 toLinear(vec3 v) {\n  return pow(v, vec3(gamma));\n}\n\nvec4 toLinear(vec4 v) {\n  return vec4(toLinear(v.rgb), v.a);\n}\n\n// Gamma\nfloat toGamma(float v) {\n  return pow(v, 1.0 / gamma);\n}\n\nvec2 toGamma(vec2 v) {\n  return pow(v, vec2(1.0 / gamma));\n}\n\nvec3 toGamma(vec3 v) {\n  return pow(v, vec3(1.0 / gamma));\n}\n\nvec4 toGamma(vec4 v) {\n  return vec4(toGamma(v.rgb), v.a);\n}\n"},8832:t=>{t.exports="\nvec3 decodeRGBM (vec4 rgbm) {\n  vec3 r = rgbm.rgb * (7.0 * rgbm.a);\n  return r * r;\n}\n\nvec4 encodeRGBM (vec3 rgb_0) {\n  vec4 r;\n  r.xyz = (1.0 / 7.0) * sqrt(rgb_0);\n  r.a = max(max(r.x, r.y), r.z);\n  r.a = clamp(r.a, 1.0 / 255.0, 1.0);\n  r.a = ceil(r.a * 255.0) / 255.0;\n  r.xyz /= r.a;\n  return r;\n}\n"},4569:t=>{t.exports="\nattribute vec2 aPosition;\nattribute vec2 aTexCoord0;\n\nuniform vec4 uViewport;\nuniform vec4 uRect;\n\nvarying vec2 vTexCoord0;\n\nvoid main() {\n  vTexCoord0 = vec2(aTexCoord0.x, 1.0 - aTexCoord0.y);\n  vec2 vertexPos = aPosition * 0.5 + 0.5;\n\n  vec2 pos = vec2(0.0, 0.0); // window pos\n  vec2 windowSize = vec2(uViewport.z - uViewport.x, uViewport.w - uViewport.y);\n  pos.x = uRect.x / windowSize.x + vertexPos.x * (uRect.z - uRect.x) / windowSize.x;\n  pos.y = uRect.y / windowSize.y + vertexPos.y * (uRect.w - uRect.y) / windowSize.y;\n  pos.y = 1.0 - pos.y;\n  pos = pos * 2.0 - 1.0;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n}"},45:(t,e,r)=>{const i=r(2278),n=r(5354),a=r(8832),o=r(2563);t.exports=`${i?"":"#version 100\nprecision highp float;"}\n${n}\n${a}\n${o}\n\nuniform sampler2D uTexture;\nuniform int uTextureEncoding;\nvarying vec2 vTexCoord0;\n\nvoid main() {\n  vec4 color = texture2D(uTexture, vTexCoord0);\n  color = decode(color, uTextureEncoding);\n  // if LINEAR || RGBM then tonemap\n  if (uTextureEncoding == LINEAR || uTextureEncoding == RGBM) {\n    color.rgb = color.rgb / (color.rgb + 1.0);\n  }\n  gl_FragColor = encode(color, 2); // to gamma\n}`},602:(t,e,r)=>{const i=r(2278),n=r(5354),a=r(8832),o=r(2563);t.exports=`${i?"":"#version 100\nprecision highp float;"}\n${n}\n${a}\n${o}\n\nconst float PI = 3.1415926;\n\nvarying vec2 vTexCoord0;\n\nuniform samplerCube uTexture;\nuniform int uTextureEncoding;\nuniform float uLevel;\nuniform float uFlipEnvMap;\n\nvoid main() {\n  float theta = PI * (vTexCoord0.x * 2.0);\n  float phi = PI * (1.0 - vTexCoord0.y);\n\n  float x = sin(phi) * sin(theta);\n  float y = -cos(phi);\n  float z = -sin(phi) * cos(theta);\n\n  vec3 N = normalize(vec3(uFlipEnvMap * x, y, z));\n  vec4 color = textureCube(uTexture, N, uLevel);\n  color = decode(color, uTextureEncoding);\n  // if LINEAR || RGBM then tonemap\n  if (uTextureEncoding == LINEAR || uTextureEncoding == RGBM) {\n    color.rgb = color.rgb / (color.rgb + 1.0);\n  }\n  gl_FragColor = encode(color, 2); // to gamma\n}`},9298:t=>{t.exports={fontFamily:"Monaco",fontSize:"10px",color:"rgba(255, 255, 255, 1)",background:"rgba(0, 0, 0, 0.56)",colorActive:"rgba(100, 100, 100, 1)",tabShadow:"rgba(0, 0, 0, 0.5)",tabBackground:"rgba(75, 75, 75, 1)",tabColor:"rgba(175, 175, 175, 1)",tabBackgroundActive:"rgba(46, 204, 113, 1)",tabColorActive:"rgba(0, 0, 0, 1)",headerBackground:"rgba(255, 255, 255, 1)",headerColor:"rgba(0, 0, 0, 1)",graphBackground:"rgba(50, 50, 50, 1)",input:"rgba(150, 150, 150, 1)",accent:"rgba(255, 255, 0, 1)"}},9003:()=>{}},e={};function r(i){var n=e[i];if(void 0!==n)return n.exports;var a=e[i]={exports:{}};return t[i].call(a.exports,a,a.exports,r),a.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{const t=r(6270),{load:e}=r(5021),i=r(2765),{perspective:n,orbiter:a}=r(7128),{mat4:o,quat:s}=r(3729),c=r(7919),l=r(5858),u=r(8033),h={currentRadioListChoice:0,radioListChoices:["Choice 1","Choice 2","Choice 3"].map(((t,e)=>({name:t,value:e}))),checkboxValue:!1,message:"Message",range:0,position:[2,0],rgba:[.92,.2,.2,1],hsb:[.2,.92,.2,1],textureParam:null,cubeTextureParam:null,currentTexture:0,textures:[]},f={scale:1,rotate:!1,time:0,size:[1,.2],rotation:[0,0,0],bgColor:[.2,.2,.2,1],currentGeometry:0,geometries:[]},d=i({pixelRatio:2}),p=t(d),g=n({fov:Math.PI/4,aspect:d.gl.drawingBufferWidth/d.gl.drawingBufferHeight,near:.1,far:100,position:[0,0,-5],target:[0,0,0]}),m=a({camera:g}),v=u?"assets":"//assets";e({palette:{image:v+"/rainbow.jpg"},plask:{image:v+"/plask.png"},pex:{image:v+"/pex.png"},noise:{image:v+"/noise.png"},posx:{image:v+"/pisa/pisa_posx.jpg"},negx:{image:v+"/pisa/pisa_negx.jpg"},posy:{image:v+"/pisa/pisa_posy.jpg"},negy:{image:v+"/pisa/pisa_negy.jpg"},posz:{image:v+"/pisa/pisa_posz.jpg"},negz:{image:v+"/pisa/pisa_negz.jpg"}},((t,e)=>{if(t)throw t;h.textures=[d.texture2D({data:e.plask,width:e.plask.width,height:e.plask.height,flipY:!0,wrap:d.Wrap.Repeat,encoding:d.Encoding.SRGB}),d.texture2D({data:e.pex,width:e.pex.width,height:e.pex.height,flipY:!0,wrap:d.Wrap.Repeat,encoding:d.Encoding.SRGB}),d.texture2D({data:e.noise,width:e.noise.width,height:e.noise.height,flipY:!0,wrap:d.Wrap.Repeat,encoding:d.Encoding.SRGB})],h.cubeTexture=d.textureCube({data:[e.posx,e.negx,e.posy,e.negy,e.posz,e.negz],width:64,height:64}),h.textureParam=h.textures[0],h.cubeTextureParam=h.cubeTexture,d.update(h.textures[0],{mipmap:!0,min:d.Filter.LinearMipmapLinear,aniso:16}),function(t){p.addTab("Controls"),p.addColumn("Inputs"),p.addLabel("Special Parameters"),p.addButton("Button",(()=>{console.log("Called back")})),p.addRadioList("Radio list",h,"currentRadioListChoice",h.radioListChoices),p.addSeparator(),p.addLabel("Smart Parameters"),p.addParam("Checkbox",h,"checkboxValue"),p.addParam("Text message",h,"message",{},(function(t){console.log(t)})),p.addParam("Slider",h,"range",{min:-Math.PI/2,max:Math.PI/2}),p.addParam("Multi Slider",h,"position",{min:0,max:10}),p.addColumn("Colors"),p.addParam("Color [RGBA]",h,"rgba"),p.addParam("Color [HSB]",h,"hsb",{type:"color",palette2:t.palette}),p.addColumn("Textures"),p.addParam("Single",h,"textureParam"),p.addTexture2DList("List",h,"currentTexture",h.textures.map(((t,e)=>({texture:t,value:e})))),p.addParam("Cube",h,"cubeTextureParam"),p.addColumn("Graphs"),p.addFPSMeeter(),p.addTab("Example"),p.addColumn("Settings"),p.addParam("Scale",f,"scale",{min:.1,max:2}),p.addParam("Rotate camera",f,"rotate"),p.addParam("Rotation",f,"rotation",{min:-Math.PI/2,max:Math.PI/2}),p.addHeader("Color"),p.addParam("BG Color [RGBA]",f,"bgColor"),p.addParam("BG Color [HSB]",f,"bgColor",{type:"color",palette2:t.palette}),p.addColumn("Geometry"),p.addRadioList("Type",f,"currentGeometry",f.geometries),p.addParam("Torus Size",f,"size",{min:.1,max:2},(()=>{const t=c({majorRadius:f.size[0],minorRadius:f.size[1]});d.update(f.geometries[1].attributes.aPosition,{data:t.positions})})),p.addColumn("Texture"),p.addTexture2D("Default",h.textures[1]),p.addTexture2DList("Default",h,"currentTexture",h.textures.map((function(t,e){return{texture:t,value:e}})))}(e)}));const x={pass:d.pass({clearColor:f.bgColor,clearDepth:1})},y=l();f.geometries.push({name:"Cube",value:0,attributes:{aPosition:d.vertexBuffer(y.positions),aTexCoord:d.vertexBuffer(y.uvs)},indices:d.indexBuffer(y.cells)});const b=c();f.geometries.push({name:"Torus",value:1,attributes:{aPosition:d.vertexBuffer(b.positions),aTexCoord:d.vertexBuffer(b.uvs)},indices:d.indexBuffer(b.cells)});const w=o.create(),E=s.create(),A={name:"drawCmd",pipeline:d.pipeline({vert:"\nattribute vec2 aTexCoord;\nattribute vec3 aPosition;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uModelMatrix;\nvarying vec2 vTexCoord;\nvoid main() {\n  vTexCoord = aTexCoord;\n  gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aPosition, 1.0);\n}\n",frag:"\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nuniform vec2 uRepeat;\nvoid main() {\n  gl_FragColor = texture2D(uTexture, vTexCoord * uRepeat);\n}",depthTest:!0}),uniforms:{uProjectionMatrix:g.projectionMatrix,uViewMatrix:g.viewMatrix,uModelMatrix:w,uRepeat:[1,1]}};let T=0;d.frame((function(){d.debug(10==T++),d.submit(x),s.setEuler(E,f.rotation[0],f.rotation[1],f.rotation[2]),o.fromQuat(w,E),o.scale(w,[f.scale,f.scale,f.scale]),f.rotate&&(f.time+=1/60,g.set({position:[5*Math.cos(f.time*Math.PI),3*Math.sin(.5*f.time),5*Math.sin(f.time*Math.PI)]}),m.set({camera:g})),h.textures.length>0&&d.submit(A,{attributes:f.geometries[f.currentGeometry].attributes,indices:f.geometries[f.currentGeometry].indices,uniforms:{uTexture:h.textures[h.currentTexture]}}),p.draw()}));const M=()=>{const t=window.innerWidth,e=window.innerHeight;d.set({width:t,height:e}),g.set({aspect:t/e}),p.scale=Math.min(Math.min(t/800,e/500),1)};window.addEventListener("resize",M),M()})()})();